<div class="content-wrapper">
  <section class="content">
    <div class="container-fluid">
      <div style="padding-top: 50px !important;" class=" text-right mt-5">
        <button routerLink="/admin/list-planning-cours-examen/planning-examen/list-planning-examen" class="btn btn-success mr-2">
          <i class="fas fa-arrow-alt-circle-left"></i> Retour
        </button>
      </div>
      <div class="row mb-2">
        <div class="col-sm-12 text-center mb-4">
          <h1 class="add-title" >Ajouter une allocation d'examinateur</h1>
        </div>
          <div class="col-12 col-md-6 mx-auto">
              <form  [formGroup]="PlanningForm" (ngSubmit)="onSubmit()" >
                <div  class="input-group mb-3">
                  <nz-select  nzPlaceHolder="Choisir une catégorie"  (ngModelChange)="changeCatgory($event)" [nzNotFoundContent]="'Pas de résultat'" formControlName="cat_formation" [ngClass]="{ 'is-invalid': submitted && f.cat_formation.errors }" >
                    <nz-option *ngFor="let itemCat of categories" nzLabel="{{itemCat.nom_categorie}}" [nzValue]="itemCat.nom_categorie"></nz-option>
                  </nz-select>
                  <div *ngIf="submitted && f.cat_formation.errors" class="invalid-feedback">
                    <div *ngIf="f.cat_formation.errors.required">catégorie est obligatoire</div>
                </div>
                </div>

                <div *ngIf="displayRef" class="input-group mb-3">
                  <nz-select nzShowSearch  nzPlaceHolder="Choisir une référence" (ngModelChange)="onchange($event)" [nzNotFoundContent]="'Pas de résultat'" formControlName="ref_formation" [ngClass]="{ 'is-invalid': submitted && f.ref_formation.errors }" >
                    <nz-option nzCustomContent nzDisabled   *ngFor="let item_sess of filterallref" [nzLabel]="item_sess.ref_form" [nzValue]="item_sess.ref_form">
                      <span   nz-tooltip   nzTooltipPlacement="right" nzTooltipTitle="Pas de date">{{item_sess.ref_form}}</span>
                    </nz-option>
                    <nz-option *ngFor="let item_session of session" nzLabel="{{item_session.ref_form}}" [nzValue]="item_session.ref_form"></nz-option>
                  </nz-select>
                  <div *ngIf="submitted && f.ref_formation.errors" class="invalid-feedback">
                    <div *ngIf="f.ref_formation.errors.required">Référence est obligatoire</div>
                </div>
                </div>
                <div *ngIf="displayVersion" class="input-group mb-3">
                  <nz-select nzShowSearch  nzPlaceHolder="Choisir une version" (ngModelChange)="changeVersion($event)" [nzNotFoundContent]="'Pas de résultat'" formControlName="version_formation" [ngClass]="{ 'is-invalid': submitted && f.version_formation.errors }" >
                    <nz-option *ngFor="let item_version of versions" nzLabel="{{item_version.version}}" [nzValue]="item_version.version"></nz-option>
                  </nz-select>
                  <div *ngIf="submitted && f.version_formation.errors" class="invalid-feedback">
                    <div *ngIf="f.version_formation.errors.required">version est obligatoire</div>
                </div>
                </div>
                <div *ngIf="displayPays"  class="input-group mb-3">
                  <nz-select nzShowSearch  nzPlaceHolder="Choisir un pays" (ngModelChange)="changePays($event)" [nzNotFoundContent]="'Pas de résultat'" formControlName="pays_formation" [ngClass]="{ 'is-invalid': submitted && f.pays_formation.errors }" >
                    <nz-option *ngFor="let item_pays of pays" nzLabel="{{item_pays.lieu}}" [nzValue]="item_pays.lieu"></nz-option>
                  </nz-select>
                  <div *ngIf="submitted && f.pays_formation.errors" class="invalid-feedback">
                    <div *ngIf="f.pays_formation.errors.required">pays est obligatoire</div>
                </div>
                </div>

                <div *ngIf="displayDate"  class="input-group mb-3">
                  <nz-select nzShowSearch  nzPlaceHolder="Choisir une date" (ngModelChange)="getIdSession($event)" [nzNotFoundContent]="'Pas de résultat'" formControlName="date_formation" [ngClass]="{ 'is-invalid': submitted && f.date_formation.errors }" >
                    <nz-option nzCustomContent *ngFor="let item_date of dates"  [nzDisabled]="item_date.affecter != null"     nzLabel="{{item_date.date_examen | date:'y-MM-d à HH:mm'}}" [nzValue]="item_date.id">
                      <span   nz-tooltip  nzTooltipPlacement="right" [nzTooltipTitle]="item_date.affecter != null ? item_date.name : ''"  >{{item_date.date_examen | date:'y-MM-d à HH:mm'}}</span>
                    </nz-option>
                  </nz-select>
                  <div *ngIf="submitted && f.date_formation.errors" class="invalid-feedback">
                    <div *ngIf="f.date_formation.errors.required">date est obligatoire</div>
                </div>
                </div>

                <div *ngIf="displayFormateur"  class="input-group mb-3">
                  <nz-select nzShowSearch  nzPlaceHolder="Choisir nom de l'examinateur" (ngModelChange)="getEmail($event)" [nzNotFoundContent]="'Pas de résultat'" formControlName="name" [ngClass]="{ 'is-invalid': submitted && f.name.errors }" >
                    <nz-option nzCustomContent *ngFor="let item of dataFormateurFilter"  [nzDisabled]="item.reserved"     nzLabel="{{item.nom }} {{item.prenom }}" [nzValue]="item.id">
                      <span   nz-tooltip  nzTooltipPlacement="right" [nzTooltipTitle]="item.reserved ? item.reserved : ''"  > {{item.nom }} {{item.prenom }} </span>
                    </nz-option>
                  </nz-select>
                  <div *ngIf="submitted && f.name.errors" class="invalid-feedback">
                    <div *ngIf="f.name.errors.required">nom de l'examinateur est obligatoire</div>
                </div>
                </div>

                <div  class="input-group mb-3">
                  <nz-select  nzAllowClear nzPlaceHolder="Choisir statut d'examinateur" [nzNotFoundContent]="'Pas de résultat'" formControlName="statut_f" [ngClass]="{ 'is-invalid': submitted && f.statut_f.errors }" >
                    <nz-option  nzLabel="En attente de confirmation" nzValue="En attente de confirmation"></nz-option>
                    <nz-option  nzLabel="Confirmée" nzValue="Confirmée"></nz-option>
                  </nz-select>
                  <div *ngIf="submitted && f.statut_f.errors" class="invalid-feedback">
                    <div *ngIf="f.statut_f.errors.required">statut d'examinateur est obligatoire</div>
                </div>
                </div>

                    <div class="input-group mb-3">
                      <input nz-input placeholder="Nombre estimé des participants" formControlName="nbr_participant" [ngClass]="{ 'is-invalid': submitted && f.nbr_participant.errors }"  />
                      <div *ngIf="submitted && f.nbr_participant.errors" class="invalid-feedback">
                        <div *ngIf="f.nbr_participant.errors.required">Nombre estimé des participants est obligatoire</div>
                    </div>
                    </div>
                  <div class="row">

                    <!-- /.col -->
                    <div class="col-12 mb-4 text-center">
                      <button  type="submit"  [nzLoading]="isLoading" nz-button nzType="primary" nzBlock>Enregistrer</button>
                    </div>
                    <!-- /.col -->
                  </div>
                </form>

          </div>
      </div>
    </div>
</section>
</div>

