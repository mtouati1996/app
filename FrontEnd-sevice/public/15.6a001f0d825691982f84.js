(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"3AMe":function(t,n,e){"use strict";e.r(n),e.d(n,"PlanningFormateurModule",(function(){return Jn}));var i=e("ofXK"),r=e("JzjI"),o=e("wd/R"),s=e("fXoL"),a=e("VvmD"),c=e("tyNb");function l(t,n){1&t&&(s.bc(0,"button",14),s.Wb(1,"i",15),s.Rc(2," Retour "),s.ac())}function u(t,n){1&t&&(s.bc(0,"button",16),s.Wb(1,"i",15),s.Rc(2," Retour "),s.ac())}function d(t,n){if(1&t&&(s.bc(0,"p",12),s.Rc(1," Version: "),s.bc(2,"b"),s.Rc(3),s.ac(),s.ac()),2&t){const t=s.pc();s.Hb(3),s.Sc(null==t.Result?null:t.Result.version)}}function f(t,n){if(1&t&&(s.bc(0,"p",12),s.Rc(1,"Nom de l'instructeur: "),s.bc(2,"b"),s.Rc(3),s.ac(),s.ac()),2&t){const t=s.pc();s.Hb(3),s.Tc(" ",null==t.Result?null:t.Result.name,"")}}function m(t,n){if(1&t&&(s.bc(0,"p",12),s.Rc(1,"Adresse: "),s.bc(2,"b"),s.Rc(3),s.ac(),s.ac()),2&t){const t=s.pc();s.Hb(3),s.Tc(" ",null==t.Result?null:t.Result.address,"")}}let b=(()=>{class t{constructor(t,n){this.planningService=t,this.route=n}ngOnInit(){this.dateYestarday=o(new Date).add(-1,"days").format("YYYY-MM-DD"),this.id=this.route.snapshot.paramMap.get("id"),this.planningService.getPlanningById(this.id).subscribe(t=>{this.Result=t.result[0]})}}return t.\u0275fac=function(n){return new(n||t)(s.Vb(a.a),s.Vb(c.a))},t.\u0275cmp=s.Pb({type:t,selectors:[["app-show-planning"]],decls:54,vars:20,consts:[[1,"content-wrapper"],[1,"content"],[1,"container-fluid"],[1,"text-right","mt-5",2,"padding-top","50px !important"],["routerLink","/admin/list-planning-cours-examen/planning-cours/list-planning-cours","class","btn btn-success mr-2",4,"ngIf"],["routerLink","/admin/list-planning-cours-examen-inactive/planning-cours/list-planning-cours-inactive","class","btn btn-success mr-2",4,"ngIf"],[1,"row","mb-2","mt-4"],[1,"col-12","col-sm-6","col-md-12","col-lg-12"],[1,"card","bg-light"],[1,"card-body","pt-5"],[1,"row"],[1,"col-12"],[1,"lead","text-muted"],["class","lead text-muted",4,"ngIf"],["routerLink","/admin/list-planning-cours-examen/planning-cours/list-planning-cours",1,"btn","btn-success","mr-2"],[1,"fas","fa-arrow-alt-circle-left"],["routerLink","/admin/list-planning-cours-examen-inactive/planning-cours/list-planning-cours-inactive",1,"btn","btn-success","mr-2"]],template:function(t,n){1&t&&(s.bc(0,"div",0),s.bc(1,"section",1),s.bc(2,"div",2),s.bc(3,"div",3),s.Pc(4,l,3,0,"button",4),s.Pc(5,u,3,0,"button",5),s.ac(),s.bc(6,"div",6),s.bc(7,"div",7),s.bc(8,"div",8),s.bc(9,"div",9),s.bc(10,"div",10),s.bc(11,"div",11),s.bc(12,"p",12),s.Rc(13," R\xe9f\xe9rence: "),s.bc(14,"b"),s.Rc(15),s.ac(),s.ac(),s.Pc(16,d,4,1,"p",13),s.bc(17,"p",12),s.Rc(18,"Date de d\xe9but: "),s.bc(19,"b"),s.Rc(20),s.qc(21,"date"),s.ac(),s.ac(),s.bc(22,"p",12),s.Rc(23,"Date de fin: "),s.bc(24,"b"),s.Rc(25),s.qc(26,"date"),s.ac(),s.ac(),s.Pc(27,f,4,1,"p",13),s.bc(28,"p",12),s.Rc(29,"Statut d'instructeur: "),s.bc(30,"b"),s.Rc(31),s.qc(32,"titlecase"),s.ac(),s.ac(),s.bc(33,"p",12),s.Rc(34,"Nom du Fournisseur: "),s.bc(35,"b"),s.Rc(36),s.ac(),s.ac(),s.Pc(37,m,4,1,"p",13),s.bc(38,"p",12),s.Rc(39,"Nbr estim\xe9 des participants: "),s.bc(40,"b"),s.Rc(41),s.ac(),s.ac(),s.bc(42,"p",12),s.Rc(43,"Num\xe9ro du contact: "),s.bc(44,"b"),s.Rc(45),s.ac(),s.ac(),s.bc(46,"p",12),s.Rc(47,"Mail du contact: "),s.bc(48,"b"),s.Rc(49),s.ac(),s.ac(),s.bc(50,"p",12),s.Rc(51,"Contact : "),s.bc(52,"b"),s.Rc(53),s.ac(),s.ac(),s.ac(),s.ac(),s.ac(),s.ac(),s.ac(),s.ac(),s.ac(),s.ac(),s.ac()),2&t&&(s.Hb(4),s.wc("ngIf",(null==n.Result?null:n.Result.date_fin)>n.dateYestarday),s.Hb(1),s.wc("ngIf",(null==n.Result?null:n.Result.date_fin)<n.dateYestarday),s.Hb(10),s.Sc(null==n.Result?null:n.Result.ref_formation),s.Hb(1),s.wc("ngIf",null==n.Result?null:n.Result.version),s.Hb(4),s.Tc(" ",s.rc(21,14,null==n.Result?null:n.Result.date_debut),""),s.Hb(5),s.Tc(" ",s.rc(26,16,null==n.Result?null:n.Result.date_fin)," "),s.Hb(2),s.wc("ngIf",null==n.Result?null:n.Result.name),s.Hb(4),s.Tc(" ",s.rc(32,18,null==n.Result?null:n.Result.statut_f)," "),s.Hb(5),s.Tc(" ",null==n.Result?null:n.Result.nom_fournisseur," "),s.Hb(1),s.wc("ngIf",null==n.Result?null:n.Result.address),s.Hb(4),s.Tc(" ",null==n.Result?null:n.Result.nbr_participant," "),s.Hb(4),s.Tc(" ",null==n.Result?null:n.Result.numero_for," "),s.Hb(4),s.Tc(" ",null==n.Result?null:n.Result.mail_contact," "),s.Hb(4),s.Tc(" ",null==n.Result?null:n.Result.contact_for," "))},directives:[i.n,c.d],pipes:[i.e,i.x],styles:[".lead[_ngcontent-%COMP%]{font-size:.9rem;font-weight:300}@media(max-width:768px){.lead[_ngcontent-%COMP%]{font-size:.8rem}}"]}),t})();var h=e("mrSG"),g=e("3Pt+"),p=e("5eHb"),v=e("KMDr"),_=e("la+k"),F=e("bVtK"),z=e("zAKX"),P=e("PTRe"),R=e("OzZK"),C=e("RwU8"),w=e("C2AL"),H=e("nJia");function y(t,n){1&t&&(s.bc(0,"div"),s.Rc(1," cat\xe9gorie est obligatoire "),s.ac())}function S(t,n){if(1&t&&(s.bc(0,"div",36),s.Pc(1,y,2,0,"div",37),s.ac()),2&t){const t=s.pc();s.Hb(1),s.wc("ngIf",t.f.cat_formation.errors.required)}}function N(t,n){1&t&&(s.bc(0,"div"),s.Rc(1," R\xe9f\xe9rence est obligatoire "),s.ac())}function I(t,n){if(1&t&&(s.bc(0,"div",36),s.Pc(1,N,2,0,"div",37),s.ac()),2&t){const t=s.pc();s.Hb(1),s.wc("ngIf",t.f.ref_formation.errors.required)}}function M(t,n){if(1&t&&(s.bc(0,"div",11),s.bc(1,"nz-select",38),s.Wb(2,"nz-option",13),s.ac(),s.ac()),2&t){const t=s.pc();s.Hb(1),s.wc("nzNotFoundContent","Pas de r\xe9sultat"),s.Hb(1),s.xc("nzLabel",null==t.Result?null:t.Result.version),s.wc("nzValue",null==t.Result?null:t.Result.version)}}function Y(t,n){1&t&&(s.bc(0,"div"),s.Rc(1," date est obligatoire "),s.ac())}function V(t,n){if(1&t&&(s.bc(0,"div",36),s.Pc(1,Y,2,0,"div",37),s.ac()),2&t){const t=s.pc();s.Hb(1),s.wc("ngIf",t.f.date_formation.errors.required)}}function D(t,n){if(1&t&&(s.bc(0,"nz-option",39),s.bc(1,"span",40),s.Rc(2),s.ac(),s.ac()),2&t){const t=n.$implicit;s.zc("nzLabel","",t.nom," ",t.prenom,""),s.xc("nzValue",t.id),s.wc("nzDisabled",t.reserved),s.Hb(1),s.wc("nzTooltipTitle",t.reserved?t.reserved:""),s.Hb(1),s.Uc(" ",t.nom," ",t.prenom," ")}}function x(t,n){1&t&&(s.bc(0,"div"),s.Rc(1," nom de l'instructeur est obligatoire "),s.ac())}function E(t,n){if(1&t&&(s.bc(0,"div",36),s.Pc(1,x,2,0,"div",37),s.ac()),2&t){const t=s.pc();s.Hb(1),s.wc("ngIf",t.f.name.errors.required)}}function A(t,n){1&t&&(s.bc(0,"div"),s.Rc(1," statut d'instructeur est obligatoire "),s.ac())}function L(t,n){if(1&t&&(s.bc(0,"div",36),s.Pc(1,A,2,0,"div",37),s.ac()),2&t){const t=s.pc();s.Hb(1),s.wc("ngIf",t.f.statut_f.errors.required)}}function O(t,n){if(1&t&&s.Wb(0,"nz-option",13),2&t){const t=n.$implicit;s.xc("nzLabel",t.nom_fournisseur),s.wc("nzValue",t.nom_fournisseur)}}function q(t,n){1&t&&(s.bc(0,"div"),s.Rc(1," Nom du fournisseur est obligatoire "),s.ac())}function W(t,n){if(1&t&&(s.bc(0,"div",36),s.Pc(1,q,2,0,"div",37),s.ac()),2&t){const t=s.pc();s.Hb(1),s.wc("ngIf",t.f.nom_four.errors.required)}}function B(t,n){1&t&&(s.bc(0,"div"),s.Rc(1," addresse est obligatoire "),s.ac())}function T(t,n){1&t&&(s.bc(0,"div"),s.Rc(1," addresse est invalide "),s.ac())}function j(t,n){1&t&&(s.bc(0,"div"),s.Rc(1," addresse est invalide "),s.ac())}function k(t,n){if(1&t&&(s.bc(0,"div",36),s.Pc(1,B,2,0,"div",37),s.Pc(2,T,2,0,"div",37),s.Pc(3,j,2,0,"div",37),s.ac()),2&t){const t=s.pc();s.Hb(1),s.wc("ngIf",t.f.address_four.errors.required),s.Hb(1),s.wc("ngIf",t.f.address_four.errors.trimError),s.Hb(1),s.wc("ngIf",t.f.address_four.errors.trimError2)}}function $(t,n){1&t&&(s.bc(0,"div"),s.Rc(1," Contact est obligatoire "),s.ac())}function G(t,n){1&t&&(s.bc(0,"div"),s.Rc(1," Contact est invalide "),s.ac())}function K(t,n){1&t&&(s.bc(0,"div"),s.Rc(1," Contact est invalide "),s.ac())}function U(t,n){if(1&t&&(s.bc(0,"div",36),s.Pc(1,$,2,0,"div",37),s.Pc(2,G,2,0,"div",37),s.Pc(3,K,2,0,"div",37),s.ac()),2&t){const t=s.pc();s.Hb(1),s.wc("ngIf",t.f.contact_for.errors.required),s.Hb(1),s.wc("ngIf",t.f.contact_for.errors.trimError),s.Hb(1),s.wc("ngIf",t.f.contact_for.errors.trimError2)}}function J(t,n){1&t&&(s.bc(0,"div"),s.Rc(1," Num\xe9ro du contact est obligatoire "),s.ac())}function X(t,n){if(1&t&&(s.bc(0,"div",36),s.Pc(1,J,2,0,"div",37),s.ac()),2&t){const t=s.pc();s.Hb(1),s.wc("ngIf",t.f.numero_for.errors.required)}}function Z(t,n){1&t&&(s.bc(0,"div"),s.Rc(1," Mail du contact est obligatoire "),s.ac())}function Q(t,n){1&t&&(s.bc(0,"div"),s.Rc(1," Mail du contact est invalide "),s.ac())}function tt(t,n){1&t&&(s.bc(0,"div"),s.Rc(1," Mail du contact est invalide "),s.ac())}function nt(t,n){if(1&t&&(s.bc(0,"div",36),s.Pc(1,Z,2,0,"div",37),s.Pc(2,Q,2,0,"div",37),s.Pc(3,tt,2,0,"div",37),s.ac()),2&t){const t=s.pc();s.Hb(1),s.wc("ngIf",t.f.mail_contact.errors.required),s.Hb(1),s.wc("ngIf",t.f.mail_contact.errors.trimError),s.Hb(1),s.wc("ngIf",t.f.mail_contact.errors.trimError2)}}function et(t,n){1&t&&(s.bc(0,"div"),s.Rc(1," Nombre estim\xe9 des participants est obligatoire "),s.ac())}function it(t,n){if(1&t&&(s.bc(0,"div",36),s.Pc(1,et,2,0,"div",37),s.ac()),2&t){const t=s.pc();s.Hb(1),s.wc("ngIf",t.f.nbr_participant.errors.required)}}const rt=function(t){return{"is-invalid":t}},ot=function(){return{minRows:3,maxRows:5}};let st=(()=>{class t{constructor(t,n,e,i,r,o,s,a){this.formBuilder=t,this.router=n,this.toastr=e,this.formateurService=i,this.sessionService=r,this.fornisseurService=o,this.planningService=s,this.route=a,this.submitted=!1,this.formateur=[],this.session=[],this.displayAddress=!1,this.displayVersion=!1,this.filtercours=[],this.fournisseur=[],this.dates=[],this.filterAddress=[],this.schedule=[],this.dataFormateur=[],this.d=[],this.dataAllFormateur=[],this.dataFormateurFilter=[],this.dataFormateurFil=[],this.mobile=!1,this.isLoading=!1}ngOnInit(){return Object(h.b)(this,void 0,void 0,(function*(){window.screen.width<768&&(this.mobile=!0),this.id=this.route.snapshot.paramMap.get("id"),this.dateToday=o(new Date).add(-1,"days").format("YYYY-MM-DD"),this.PlanningForm=this.formBuilder.group({name:["",[g.u.required]],statut_f:["",[g.u.required]],cat_formation:[""],version_formation:[""],type_formation:[""],lieu_formation:[""],ref_formation:[""],date_formation:[""],nom_four:["",[g.u.required]],address_four:["",[g.u.required]],nbr_participant:["",[g.u.required]],numero_for:["",[g.u.required]],mail_contact:["",[g.u.required]],contact_for:["",[g.u.required]]}),yield this.planningService.getPlanningById(this.id).subscribe(t=>{this.Result=t.result[0],this.PlanningForm.patchValue({name:this.Result.name,cat_formation:this.Result.categorie,ref_formation:this.Result.ref_formation,version_formation:this.Result.version,type_formation:this.Result.type,lieu_formation:this.Result.lieu,date_formation:`${o(this.Result.date_debut).format("DD-MM-YYYY")} / ${o(this.Result.fin).format("DD-MM-YYYY")}`,statut_f:this.Result.statut_f,nom_four:this.Result.nom_fournisseur,address_four:this.Result.address,numero_for:this.Result.numero_for,contact_for:this.Result.contact_for,mail_contact:this.Result.mail_contact,nbr_participant:this.Result.nbr_participant}),this.Result.date_formation=`${o(this.Result.date_debut).format("DD-MM-YYYY")} / ${o(this.Result.fin).format("DD-MM-YYYY")}`,null!==this.Result.version&&""!==this.Result.version&&(this.displayVersion=!0),this.fetchFormateur(),this.fetchFournisseur()})}))}get f(){return this.PlanningForm.controls}onSubmit(){if(this.submitted=!0,this.PlanningForm.invalid)return;this.isLoading=!0;const t={id_formateur:this.filterFormateur[0].id,statut_f:this.PlanningForm.value.statut_f,id_fournisseur:this.idFournisseur,address_fournisseur:this.PlanningForm.value.address_four,nbr_participant:this.PlanningForm.value.nbr_participant,numero_for:this.PlanningForm.value.numero_for,mail_contact:this.PlanningForm.value.mail_contact,contact_for:this.PlanningForm.value.contact_for};this.dateToday<o(this.Result.date_fin).format("YYYY-MM-DD")&&this.planningService.updatePlanning(this.id,t).subscribe(n=>Object(h.b)(this,void 0,void 0,(function*(){if(n.success){null!==this.Result.version&&""!==this.Result.version||(this.Result.version=null),this.filterFormateur[0].id!==this.Result.id_formateur&&this.sessionService.emailFormateurChanger(this.Result.email,this.Result.name,this.Result.ref_formation,this.Result.designation,o(this.Result.date_debut).format("DD-MM-YYYY"),o(this.Result.date_fin).format("DD-MM-YYYY")).subscribe(t=>{t.success||this.toastr.error("Erreur",t.error)}),yield this.affectedSession(this.Result.id_session,t.id_formateur);const n=this.filterFormateur[0].nom+" "+this.filterFormateur[0].prenom;yield this.envoyerEmail(this.filterFormateur[0].email,this.Result.ref_formation,o(this.Result.date_debut).format("DD-MM-YYYY"),o(this.Result.date_fin).format("DD-MM-YYYY"),this.Result.type,this.Result.langue,t.address_fournisseur,this.Result.version,t.statut_f,this.Result.etat_session,n,this.Result.designation,this.Result.lieu,t.contact_for,t.numero_for,t.mail_contact,t.nbr_participant),this.toastr.success("Succ\xe8s"),this.router.navigate(["/admin/list-planning-cours-examen/planning-cours/list-planning-cours"])}else this.toastr.error("Erreur",n.error),this.isLoading=!1})))}fetchFormateur(){return Object(h.b)(this,void 0,void 0,(function*(){this.dataFormateurFilter=[],this.dataFormateur=[],this.schedule=[],this.formateur=[],this.dataAllFormateur=[],yield this.planningService.getAllAffecteSessionFormateur().subscribe(t=>Object(h.b)(this,void 0,void 0,(function*(){this.formateur=t.result,this.formateur.forEach(t=>{t.schedule?(this.schedule=t.schedule.split(","),this.schedule.forEach(n=>{this.d=n.split("/"),o(this.Result.date_debut).isBetween(this.d[0],this.d[1],void 0,"[]")||o(this.Result.date_fin).isBetween(this.d[0],this.d[1],void 0,"[]")?this.dataFormateur.push(Object.assign(Object.assign({},t),{reserved:"R\xe9serv\xe9e par "+this.d[2]+" de "+this.d[0]+" -- "+this.d[1]})):this.dataFormateur.push(Object.assign(Object.assign({},t),{reservednot:!1}))})):this.dataFormateur.push(Object.assign(Object.assign({},t),{reservednot:!1})),this.schedule=[]});const n=this.dataFormateur.filter(t=>t.reserved),e=new Set,i=yield this.dataFormateur.filter(t=>{const n=e.has(t.id);return e.add(t.id),!n});this.dataFormateurFilter=[...n];let r=[];n.forEach(t=>{r.push(t.id)});let s=!1;i.forEach(t=>{s=!1;for(const n of r){if(t.id===n){s=!0;break}s=!1}s||this.dataFormateurFilter.push(t)}),r=[],this.dataFormateurFilter.forEach(t=>{r.push(t.id)}),this.formateurService.getAllFormateur().subscribe(t=>{this.dataAllFormateur=t.results,this.dataAllFormateur.forEach(t=>{s=!1;for(const n of r){if(t.id===n){s=!0;break}s=!1}s||this.dataFormateurFilter.push(t)}),this.dataFormateurFil=this.dataFormateurFilter.filter(t=>Number(t.id)!==Number(this.Result.id_formateur)),this.defaultGetEmail()})})))}))}changeFournisseurDefault(){if(null!==this.Result.nom_fournisseur){const t=this.PlanningForm.value.nom_four;this.fourn=this.fournisseur.filter(n=>n.nom_fournisseur===t),this.idFournisseur=this.fourn[0].id}}onchangeFournisseur(t){if(t&&this.PlanningForm.value.nom_four){this.submitted=!1;const t=this.PlanningForm.value.nom_four;this.fourn=this.fournisseur.filter(n=>n.nom_fournisseur===t),this.idFournisseur=this.fourn[0].id}}getEmail(t){t&&(this.filterFormateur=[],this.filterFormateur=this.dataFormateurFilter.filter(t=>Number(t.id)===Number(this.PlanningForm.value.name)))}defaultGetEmail(){this.filterFormateur=[],this.filterFormateur=this.dataFormateurFilter.filter(t=>Number(t.id)===this.Result.id_formateur)}fetchFournisseur(){this.fornisseurService.getAllFournisseurWithoutAdress().subscribe(t=>{this.fournisseur=t.results,this.changeFournisseurDefault()})}affectedSession(t,n){this.sessionService.updateSessionAffected(t,n).subscribe(t=>{t.success||this.toastr.error("Erreur",t.error)})}envoyerEmail(t,n,e,i,r,o,s,a,c,l,u,d,f,m,b,h,g){this.sessionService.envoyerEmailFormateur(t,n,e,i,r,o,s,a,c,l,u,d,f,m,b,h,g).subscribe(t=>{t.success||this.toastr.error("Erreur",t.error)})}}return t.\u0275fac=function(n){return new(n||t)(s.Vb(g.e),s.Vb(c.c),s.Vb(p.b),s.Vb(v.a),s.Vb(_.a),s.Vb(F.a),s.Vb(a.a),s.Vb(c.a))},t.\u0275cmp=s.Pb({type:t,selectors:[["app-edit-planning"]],decls:68,vars:75,consts:[[1,"content-wrapper"],[1,"content"],[1,"container-fluid"],[1,"text-right","mt-5",2,"padding-top","50px !important"],["routerLink","/admin/list-planning-cours-examen/planning-cours/list-planning-cours",1,"btn","btn-success","mr-2"],[1,"fas","fa-arrow-alt-circle-left"],[1,"row","mb-2"],[1,"col-sm-12","text-center","mb-4"],[1,"edit-title"],[1,"col-12","col-md-6","mx-auto"],[3,"formGroup","ngSubmit"],[1,"input-group","mb-3"],["nzPlaceHolder","Choisir une cat\xe9gorie","formControlName","cat_formation",3,"nzNotFoundContent","ngClass"],[3,"nzLabel","nzValue"],["class","invalid-feedback",4,"ngIf"],["nzPlaceHolder","Choisir une r\xe9f\xe9rence","formControlName","ref_formation",3,"nzNotFoundContent","ngClass"],["class","input-group mb-3",4,"ngIf"],["nzPlaceHolder","Choisir un type","formControlName","type_formation",3,"nzNotFoundContent"],["nzPlaceHolder","Choisir un pays","formControlName","lieu_formation",3,"nzNotFoundContent"],["nzPlaceHolder","Choisir une date","formControlName","date_formation",3,"nzNotFoundContent","ngClass"],["nzShowSearch","","nzPlaceHolder","Choisir nom de l'instructeur","formControlName","name",3,"nzNotFoundContent","ngClass","ngModelChange"],["nzCustomContent","",3,"nzDisabled","nzLabel","nzValue",4,"ngFor","ngForOf"],["nzAllowClear","","nzPlaceHolder","Choisir statut d'instructeur","formControlName","statut_f",3,"nzNotFoundContent","ngClass"],["nzLabel","En attente de confirmation","nzValue","En attente de confirmation"],["nzLabel","Confirm\xe9e","nzValue","Confirm\xe9e"],["nzLabel","Annul\xe9e","nzValue","annul\xe9e"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Choisir un fournisseur","formControlName","nom_four",3,"nzNotFoundContent","ngClass","ngModelChange"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nz-input","","placeholder","Addresse","formControlName","address_four",3,"ngClass","nzAutosize"],["nz-input","","placeholder","Contact","formControlName","contact_for",3,"ngClass"],["nz-input","","placeholder","Num\xe9ro du contact","formControlName","numero_for",3,"ngClass"],["nz-input","","placeholder","Mail du contact","formControlName","mail_contact",3,"ngClass"],["nz-input","","placeholder","Nombre estim\xe9 des participants","formControlName","nbr_participant",3,"ngClass"],[1,"row"],[1,"col-12","mb-4","text-center"],["type","submit","nz-button","","nzType","primary","nzBlock","",3,"nzLoading"],[1,"invalid-feedback"],[4,"ngIf"],["nzPlaceHolder","Choisir une version","formControlName","version_formation",3,"nzNotFoundContent"],["nzCustomContent","",3,"nzDisabled","nzLabel","nzValue"],["nz-tooltip","","nzTooltipPlacement","right",3,"nzTooltipTitle"]],template:function(t,n){1&t&&(s.bc(0,"div",0),s.bc(1,"section",1),s.bc(2,"div",2),s.bc(3,"div",3),s.bc(4,"button",4),s.Wb(5,"i",5),s.Rc(6," Retour "),s.ac(),s.ac(),s.bc(7,"div",6),s.bc(8,"div",7),s.bc(9,"h1",8),s.Rc(10,"Modifier une allocation d'instructeur"),s.ac(),s.ac(),s.bc(11,"div",9),s.bc(12,"form",10),s.mc("ngSubmit",(function(){return n.onSubmit()})),s.bc(13,"div",11),s.bc(14,"nz-select",12),s.Wb(15,"nz-option",13),s.ac(),s.Pc(16,S,2,1,"div",14),s.ac(),s.bc(17,"div",11),s.bc(18,"nz-select",15),s.Wb(19,"nz-option",13),s.ac(),s.Pc(20,I,2,1,"div",14),s.ac(),s.Pc(21,M,3,3,"div",16),s.bc(22,"div",11),s.bc(23,"nz-select",17),s.Wb(24,"nz-option",13),s.qc(25,"titlecase"),s.ac(),s.ac(),s.bc(26,"div",11),s.bc(27,"nz-select",18),s.Wb(28,"nz-option",13),s.qc(29,"titlecase"),s.ac(),s.ac(),s.bc(30,"div",11),s.bc(31,"nz-select",19),s.Wb(32,"nz-option",13),s.ac(),s.Pc(33,V,2,1,"div",14),s.ac(),s.bc(34,"div",11),s.bc(35,"nz-select",20),s.mc("ngModelChange",(function(t){return n.getEmail(t)})),s.Wb(36,"nz-option",13),s.Pc(37,D,3,7,"nz-option",21),s.ac(),s.Pc(38,E,2,1,"div",14),s.ac(),s.bc(39,"div",11),s.bc(40,"nz-select",22),s.Wb(41,"nz-option",23),s.Wb(42,"nz-option",24),s.Wb(43,"nz-option",25),s.ac(),s.Pc(44,L,2,1,"div",14),s.ac(),s.bc(45,"div",11),s.bc(46,"nz-select",26),s.mc("ngModelChange",(function(t){return n.onchangeFournisseur(t)})),s.Pc(47,O,1,2,"nz-option",27),s.ac(),s.Pc(48,W,2,1,"div",14),s.ac(),s.bc(49,"div",11),s.Wb(50,"textarea",28),s.Pc(51,k,4,3,"div",14),s.ac(),s.bc(52,"div",11),s.Wb(53,"input",29),s.Pc(54,U,4,3,"div",14),s.ac(),s.bc(55,"div",11),s.Wb(56,"input",30),s.Pc(57,X,2,1,"div",14),s.ac(),s.bc(58,"div",11),s.Wb(59,"input",31),s.Pc(60,nt,4,3,"div",14),s.ac(),s.bc(61,"div",11),s.Wb(62,"input",32),s.Pc(63,it,2,1,"div",14),s.ac(),s.bc(64,"div",33),s.bc(65,"div",34),s.bc(66,"button",35),s.Rc(67,"Enregistrer"),s.ac(),s.ac(),s.ac(),s.ac(),s.ac(),s.ac(),s.ac(),s.ac(),s.ac()),2&t&&(s.Hb(12),s.wc("formGroup",n.PlanningForm),s.Hb(2),s.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",s.Bc(52,rt,n.submitted&&n.f.cat_formation.errors)),s.Hb(1),s.xc("nzLabel",null==n.Result?null:n.Result.categorie),s.wc("nzValue",null==n.Result?null:n.Result.categorie),s.Hb(1),s.wc("ngIf",n.submitted&&n.f.cat_formation.errors),s.Hb(2),s.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",s.Bc(54,rt,n.submitted&&n.f.ref_formation.errors)),s.Hb(1),s.xc("nzLabel",null==n.Result?null:n.Result.ref_formation),s.wc("nzValue",null==n.Result?null:n.Result.ref_formation),s.Hb(1),s.wc("ngIf",n.submitted&&n.f.ref_formation.errors),s.Hb(1),s.wc("ngIf",n.displayVersion),s.Hb(2),s.wc("nzNotFoundContent","Pas de r\xe9sultat"),s.Hb(1),s.xc("nzLabel",s.rc(25,48,null==n.Result?null:n.Result.type)),s.wc("nzValue",null==n.Result?null:n.Result.type),s.Hb(3),s.wc("nzNotFoundContent","Pas de r\xe9sultat"),s.Hb(1),s.xc("nzLabel",s.rc(29,50,null==n.Result?null:n.Result.lieu)),s.wc("nzValue",null==n.Result?null:n.Result.lieu),s.Hb(3),s.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",s.Bc(56,rt,n.submitted&&n.f.date_formation.errors)),s.Hb(1),s.xc("nzLabel",null==n.Result?null:n.Result.date_formation),s.xc("nzValue",null==n.Result?null:n.Result.date_formation),s.Hb(1),s.wc("ngIf",n.submitted&&n.f.date_formation.errors),s.Hb(2),s.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",s.Bc(58,rt,n.submitted&&n.f.name.errors)),s.Hb(1),s.xc("nzLabel",null==n.Result?null:n.Result.name),s.wc("nzValue",null==n.Result?null:n.Result.name),s.Hb(1),s.wc("ngForOf",n.dataFormateurFil),s.Hb(1),s.wc("ngIf",n.submitted&&n.f.name.errors),s.Hb(2),s.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",s.Bc(60,rt,n.submitted&&n.f.statut_f.errors)),s.Hb(4),s.wc("ngIf",n.submitted&&n.f.statut_f.errors),s.Hb(2),s.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",s.Bc(62,rt,n.submitted&&n.f.nom_four.errors)),s.Hb(1),s.wc("ngForOf",n.fournisseur),s.Hb(1),s.wc("ngIf",n.submitted&&n.f.nom_four.errors),s.Hb(2),s.wc("ngClass",s.Bc(64,rt,n.submitted&&n.f.address_four.errors))("nzAutosize",s.Ac(66,ot)),s.Hb(1),s.wc("ngIf",n.submitted&&n.f.address_four.errors),s.Hb(2),s.wc("ngClass",s.Bc(67,rt,n.submitted&&n.f.contact_for.errors)),s.Hb(1),s.wc("ngIf",n.submitted&&n.f.contact_for.errors),s.Hb(2),s.wc("ngClass",s.Bc(69,rt,n.submitted&&n.f.numero_for.errors)),s.Hb(1),s.wc("ngIf",n.submitted&&n.f.numero_for.errors),s.Hb(2),s.wc("ngClass",s.Bc(71,rt,n.submitted&&n.f.mail_contact.errors)),s.Hb(1),s.wc("ngIf",n.submitted&&n.f.mail_contact.errors),s.Hb(2),s.wc("ngClass",s.Bc(73,rt,n.submitted&&n.f.nbr_participant.errors)),s.Hb(1),s.wc("ngIf",n.submitted&&n.f.nbr_participant.errors),s.Hb(3),s.wc("nzLoading",n.isLoading))},directives:[c.d,g.w,g.n,g.h,z.b,g.m,g.g,i.l,z.a,i.n,i.m,P.b,g.d,P.a,R.a,C.a,w.a,H.b],pipes:[i.x],styles:["@media(max-width:768px){.edit-title[_ngcontent-%COMP%]{font-size:1.5rem;margin-top:50px}.form-control[_ngcontent-%COMP%]{font-size:.8rem!important}}@media(min-width:768px){.add-title[_ngcontent-%COMP%]{font-size:2rem;margin-top:40px}}nz-select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{width:100%}"]}),t})();var at=e("LWzD"),ct=e("Cxpb");function lt(t,n){if(1&t&&s.Wb(0,"nz-option",27),2&t){const t=n.$implicit;s.xc("nzLabel",t.nom_categorie),s.wc("nzValue",t.nom_categorie)}}function ut(t,n){1&t&&(s.bc(0,"div"),s.Rc(1,"cat\xe9gorie est obligatoire"),s.ac())}function dt(t,n){if(1&t&&(s.bc(0,"div",28),s.Pc(1,ut,2,0,"div",29),s.ac()),2&t){const t=s.pc();s.Hb(1),s.wc("ngIf",t.f.cat_formation.errors.required)}}function ft(t,n){if(1&t&&(s.bc(0,"nz-option",32),s.bc(1,"span",33),s.Rc(2),s.ac(),s.ac()),2&t){const t=n.$implicit;s.wc("nzLabel",t.ref_form)("nzValue",t.ref_form),s.Hb(2),s.Sc(t.ref_form)}}function mt(t,n){if(1&t&&s.Wb(0,"nz-option",27),2&t){const t=n.$implicit;s.xc("nzLabel",t.ref_form),s.wc("nzValue",t.ref_form)}}function bt(t,n){1&t&&(s.bc(0,"div"),s.Rc(1,"R\xe9f\xe9rence est obligatoire"),s.ac())}function ht(t,n){if(1&t&&(s.bc(0,"div",28),s.Pc(1,bt,2,0,"div",29),s.ac()),2&t){const t=s.pc(2);s.Hb(1),s.wc("ngIf",t.f.ref_formation.errors.required)}}const gt=function(t){return{"is-invalid":t}};function pt(t,n){if(1&t){const t=s.cc();s.bc(0,"div",11),s.bc(1,"nz-select",30),s.mc("ngModelChange",(function(n){return s.Gc(t),s.pc().onchange(n)})),s.Pc(2,ft,3,3,"nz-option",31),s.Pc(3,mt,1,2,"nz-option",13),s.ac(),s.Pc(4,ht,2,1,"div",14),s.ac()}if(2&t){const t=s.pc();s.Hb(1),s.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",s.Bc(5,gt,t.submitted&&t.f.ref_formation.errors)),s.Hb(1),s.wc("ngForOf",t.filterallref),s.Hb(1),s.wc("ngForOf",t.session),s.Hb(1),s.wc("ngIf",t.submitted&&t.f.ref_formation.errors)}}function vt(t,n){if(1&t&&s.Wb(0,"nz-option",27),2&t){const t=n.$implicit;s.xc("nzLabel",t.version),s.wc("nzValue",t.version)}}function _t(t,n){1&t&&(s.bc(0,"div"),s.Rc(1,"version est obligatoire"),s.ac())}function Ft(t,n){if(1&t&&(s.bc(0,"div",28),s.Pc(1,_t,2,0,"div",29),s.ac()),2&t){const t=s.pc(2);s.Hb(1),s.wc("ngIf",t.f.version_formation.errors.required)}}function zt(t,n){if(1&t){const t=s.cc();s.bc(0,"div",11),s.bc(1,"nz-select",34),s.mc("ngModelChange",(function(n){return s.Gc(t),s.pc().changeVersion(n)})),s.Pc(2,vt,1,2,"nz-option",13),s.ac(),s.Pc(3,Ft,2,1,"div",14),s.ac()}if(2&t){const t=s.pc();s.Hb(1),s.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",s.Bc(4,gt,t.submitted&&t.f.version_formation.errors)),s.Hb(1),s.wc("ngForOf",t.versions),s.Hb(1),s.wc("ngIf",t.submitted&&t.f.version_formation.errors)}}function Pt(t,n){if(1&t&&s.Wb(0,"nz-option",27),2&t){const t=n.$implicit;s.xc("nzLabel",t.type),s.wc("nzValue",t.type)}}function Rt(t,n){1&t&&(s.bc(0,"div"),s.Rc(1,"type est obligatoire"),s.ac())}function Ct(t,n){if(1&t&&(s.bc(0,"div",28),s.Pc(1,Rt,2,0,"div",29),s.ac()),2&t){const t=s.pc(2);s.Hb(1),s.wc("ngIf",t.f.type_formation.errors.required)}}function wt(t,n){if(1&t){const t=s.cc();s.bc(0,"div",11),s.bc(1,"nz-select",35),s.mc("ngModelChange",(function(n){return s.Gc(t),s.pc().changeType(n)})),s.Pc(2,Pt,1,2,"nz-option",13),s.ac(),s.Pc(3,Ct,2,1,"div",14),s.ac()}if(2&t){const t=s.pc();s.Hb(1),s.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",s.Bc(4,gt,t.submitted&&t.f.type_formation.errors)),s.Hb(1),s.wc("ngForOf",t.types),s.Hb(1),s.wc("ngIf",t.submitted&&t.f.type_formation.errors)}}function Ht(t,n){if(1&t&&s.Wb(0,"nz-option",27),2&t){const t=n.$implicit;s.xc("nzLabel",t.lieu),s.wc("nzValue",t.lieu)}}function yt(t,n){1&t&&(s.bc(0,"div"),s.Rc(1,"pays est obligatoire"),s.ac())}function St(t,n){if(1&t&&(s.bc(0,"div",28),s.Pc(1,yt,2,0,"div",29),s.ac()),2&t){const t=s.pc(2);s.Hb(1),s.wc("ngIf",t.f.pays_formation.errors.required)}}function Nt(t,n){if(1&t){const t=s.cc();s.bc(0,"div",11),s.bc(1,"nz-select",36),s.mc("ngModelChange",(function(n){return s.Gc(t),s.pc().changePays(n)})),s.Pc(2,Ht,1,2,"nz-option",13),s.ac(),s.Pc(3,St,2,1,"div",14),s.ac()}if(2&t){const t=s.pc();s.Hb(1),s.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",s.Bc(4,gt,t.submitted&&t.f.pays_formation.errors)),s.Hb(1),s.wc("ngForOf",t.pays),s.Hb(1),s.wc("ngIf",t.submitted&&t.f.pays_formation.errors)}}function It(t,n){if(1&t&&(s.bc(0,"nz-option",39),s.qc(1,"date"),s.qc(2,"date"),s.bc(3,"span",40),s.Rc(4),s.qc(5,"date"),s.qc(6,"date"),s.ac(),s.ac()),2&t){const t=n.$implicit;s.zc("nzLabel","",s.sc(1,7,t.date_debut,"longDate")," -- ",s.sc(2,10,t.date_fin,"longDate"),""),s.wc("nzDisabled",null!=t.affecter)("nzValue",t.id),s.Hb(3),s.wc("nzTooltipTitle",null!=t.affecter?t.name:""),s.Hb(1),s.Uc("",s.sc(5,13,t.date_debut,"longDate")," -- ",s.sc(6,16,t.date_fin,"longDate"),"")}}function Mt(t,n){1&t&&(s.bc(0,"div"),s.Rc(1,"date est obligatoire"),s.ac())}function Yt(t,n){if(1&t&&(s.bc(0,"div",28),s.Pc(1,Mt,2,0,"div",29),s.ac()),2&t){const t=s.pc(2);s.Hb(1),s.wc("ngIf",t.f.date_formation.errors.required)}}function Vt(t,n){if(1&t){const t=s.cc();s.bc(0,"div",11),s.bc(1,"nz-select",37),s.mc("ngModelChange",(function(n){return s.Gc(t),s.pc().getIdSession(n)})),s.Pc(2,It,7,19,"nz-option",38),s.ac(),s.Pc(3,Yt,2,1,"div",14),s.ac()}if(2&t){const t=s.pc();s.Hb(1),s.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",s.Bc(4,gt,t.submitted&&t.f.date_formation.errors)),s.Hb(1),s.wc("ngForOf",t.dates),s.Hb(1),s.wc("ngIf",t.submitted&&t.f.date_formation.errors)}}function Dt(t,n){if(1&t&&(s.bc(0,"nz-option",39),s.bc(1,"span",40),s.Rc(2),s.ac(),s.ac()),2&t){const t=n.$implicit;s.zc("nzLabel","",t.nom," ",t.prenom,""),s.wc("nzDisabled",t.reserved)("nzValue",t.id),s.Hb(1),s.wc("nzTooltipTitle",t.reserved?t.reserved:""),s.Hb(1),s.Uc(" ",t.nom," ",t.prenom," ")}}function xt(t,n){1&t&&(s.bc(0,"div"),s.Rc(1,"nom de l'instructeur est obligatoire"),s.ac())}function Et(t,n){if(1&t&&(s.bc(0,"div",28),s.Pc(1,xt,2,0,"div",29),s.ac()),2&t){const t=s.pc(2);s.Hb(1),s.wc("ngIf",t.f.name.errors.required)}}function At(t,n){if(1&t){const t=s.cc();s.bc(0,"div",11),s.bc(1,"nz-select",41),s.mc("ngModelChange",(function(n){return s.Gc(t),s.pc().getEmail(n)})),s.Pc(2,Dt,3,7,"nz-option",38),s.ac(),s.Pc(3,Et,2,1,"div",14),s.ac()}if(2&t){const t=s.pc();s.Hb(1),s.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",s.Bc(4,gt,t.submitted&&t.f.name.errors)),s.Hb(1),s.wc("ngForOf",t.dataFormateurFilter),s.Hb(1),s.wc("ngIf",t.submitted&&t.f.name.errors)}}function Lt(t,n){1&t&&(s.bc(0,"div"),s.Rc(1,"statut d'instructeur est obligatoire"),s.ac())}function Ot(t,n){if(1&t&&(s.bc(0,"div",28),s.Pc(1,Lt,2,0,"div",29),s.ac()),2&t){const t=s.pc();s.Hb(1),s.wc("ngIf",t.f.statut_f.errors.required)}}function qt(t,n){if(1&t&&s.Wb(0,"nz-option",27),2&t){const t=n.$implicit;s.xc("nzLabel",t.nom_fournisseur),s.wc("nzValue",t.nom_fournisseur)}}function Wt(t,n){1&t&&(s.bc(0,"div"),s.Rc(1,"Nom du fournisseur est obligatoire"),s.ac())}function Bt(t,n){if(1&t&&(s.bc(0,"div",28),s.Pc(1,Wt,2,0,"div",29),s.ac()),2&t){const t=s.pc();s.Hb(1),s.wc("ngIf",t.f.nom_four.errors.required)}}function Tt(t,n){1&t&&(s.bc(0,"div"),s.Rc(1,"addresse est obligatoire"),s.ac())}function jt(t,n){1&t&&(s.bc(0,"div"),s.Rc(1,"addresse est invalide"),s.ac())}function kt(t,n){1&t&&(s.bc(0,"div"),s.Rc(1,"addresse est invalide"),s.ac())}function $t(t,n){if(1&t&&(s.bc(0,"div",28),s.Pc(1,Tt,2,0,"div",29),s.Pc(2,jt,2,0,"div",29),s.Pc(3,kt,2,0,"div",29),s.ac()),2&t){const t=s.pc(2);s.Hb(1),s.wc("ngIf",t.f.address_four.errors.required),s.Hb(1),s.wc("ngIf",t.f.address_four.errors.trimError),s.Hb(1),s.wc("ngIf",t.f.address_four.errors.trimError2)}}const Gt=function(){return{minRows:3,maxRows:5}};function Kt(t,n){if(1&t&&(s.bc(0,"div",11),s.Wb(1,"textarea",42),s.Pc(2,$t,4,3,"div",14),s.ac()),2&t){const t=s.pc();s.Hb(1),s.wc("ngClass",s.Bc(3,gt,t.submitted&&t.f.address_four.errors))("nzAutosize",s.Ac(5,Gt)),s.Hb(1),s.wc("ngIf",t.submitted&&t.f.address_four.errors)}}function Ut(t,n){1&t&&(s.bc(0,"div"),s.Rc(1,"Contact est obligatoire"),s.ac())}function Jt(t,n){1&t&&(s.bc(0,"div"),s.Rc(1,"Contact est invalide"),s.ac())}function Xt(t,n){1&t&&(s.bc(0,"div"),s.Rc(1,"Contact est invalide"),s.ac())}function Zt(t,n){if(1&t&&(s.bc(0,"div",28),s.Pc(1,Ut,2,0,"div",29),s.Pc(2,Jt,2,0,"div",29),s.Pc(3,Xt,2,0,"div",29),s.ac()),2&t){const t=s.pc();s.Hb(1),s.wc("ngIf",t.f.contact_for.errors.required),s.Hb(1),s.wc("ngIf",t.f.contact_for.errors.trimError),s.Hb(1),s.wc("ngIf",t.f.contact_for.errors.trimError2)}}function Qt(t,n){1&t&&(s.bc(0,"div"),s.Rc(1,"Num\xe9ro du contact est obligatoire"),s.ac())}function tn(t,n){if(1&t&&(s.bc(0,"div",28),s.Pc(1,Qt,2,0,"div",29),s.ac()),2&t){const t=s.pc();s.Hb(1),s.wc("ngIf",t.f.numero_for.errors.required)}}function nn(t,n){1&t&&(s.bc(0,"div"),s.Rc(1,"Mail du contact est obligatoire"),s.ac())}function en(t,n){1&t&&(s.bc(0,"div"),s.Rc(1,"Mail du contact est invalide"),s.ac())}function rn(t,n){1&t&&(s.bc(0,"div"),s.Rc(1,"Mail du contact est invalide"),s.ac())}function on(t,n){if(1&t&&(s.bc(0,"div",28),s.Pc(1,nn,2,0,"div",29),s.Pc(2,en,2,0,"div",29),s.Pc(3,rn,2,0,"div",29),s.ac()),2&t){const t=s.pc();s.Hb(1),s.wc("ngIf",t.f.mail_contact.errors.required),s.Hb(1),s.wc("ngIf",t.f.mail_contact.errors.trimError),s.Hb(1),s.wc("ngIf",t.f.mail_contact.errors.trimError2)}}function sn(t,n){1&t&&(s.bc(0,"div"),s.Rc(1,"Nombre estim\xe9 des participants est obligatoire"),s.ac())}function an(t,n){if(1&t&&(s.bc(0,"div",28),s.Pc(1,sn,2,0,"div",29),s.ac()),2&t){const t=s.pc();s.Hb(1),s.wc("ngIf",t.f.nbr_participant.errors.required)}}let cn=(()=>{class t{constructor(t,n,e,i,r,o,s,a,c){this.formBuilder=t,this.router=n,this.toastr=e,this.sessionService=i,this.coursService=r,this.fornisseurService=o,this.planningService=s,this.categorieService=a,this.formateurService=c,this.submitted=!1,this.formateur=[],this.session=[],this.displayDate=!1,this.displayAddress=!1,this.displayFormateur=!1,this.displayRef=!1,this.displayVersion=!1,this.displayType=!1,this.displayPays=!1,this.filtercours=[],this.fournisseur=[],this.dates=[],this.filterSession=[],this.filterAddress=[],this.schedule=[],this.dataFormateur=[],this.d=[],this.dataFormateurFilter=[],this.categories=[],this.versions=[],this.types=[],this.pays=[],this.dataAllFormateur=[],this.allref=[],this.filterallref=[],this.mobile=!1,this.isLoading=!1,this.trimValidator=t=>t.value.startsWith(" ")?{trimError:{value:"control has leading whitespace"}}:t.value.endsWith(" ")?{trimError2:{value:"control has trailing whitespace"}}:null}ngOnInit(){window.screen.width<768&&(this.mobile=!0),this.fetchCategorie(),this.fetchFournisseur(),this.PlanningForm=this.formBuilder.group({name:["",[g.u.required]],statut_f:["",[g.u.required]],ref_formation:["",[g.u.required]],version_formation:[""],type_formation:["",[g.u.required]],pays_formation:[""],date_formation:["",[g.u.required]],cat_formation:[""],nom_four:["",[g.u.required]],address_four:[""],nbr_participant:["",[g.u.required]],numero_for:["",[g.u.required]],mail_contact:["",[g.u.required,this.trimValidator]],contact_for:["",[g.u.required,this.trimValidator]]})}get f(){return this.PlanningForm.controls}onSubmit(){if(this.submitted=!0,this.PlanningForm.invalid)return;this.isLoading=!0;const t={id_formateur:Number(this.PlanningForm.value.name),id_session:Number(this.PlanningForm.value.date_formation),statut_f:this.PlanningForm.value.statut_f,id_fournisseur:this.idFournisseur,address_fournisseur:this.PlanningForm.value.address_four||null,nbr_participant:this.PlanningForm.value.nbr_participant,numero_for:this.PlanningForm.value.numero_for,mail_contact:this.PlanningForm.value.mail_contact,contact_for:this.PlanningForm.value.contact_for};this.planningService.savePlanning(t).subscribe(n=>Object(h.b)(this,void 0,void 0,(function*(){if(n.success){yield this.affectedSession(t.id_session,t.id_formateur);const n=this.filterFormateur[0].nom+" "+this.filterFormateur[0].prenom;null!==this.versions[0].version&&""!==this.versions[0].version||(this.PlanningForm.value.version_formation=null),"pr\xe9sentielle"===this.PlanningForm.value.type_formation?yield this.envoyerEmail(this.filterFormateur[0].email,this.PlanningForm.value.ref_formation,o(this.filterSession[0].date_debut).format("DD-MM-YYYY"),o(this.filterSession[0].date_fin).format("DD-MM-YYYY"),this.PlanningForm.value.type_formation,this.filterSession[0].langue,this.PlanningForm.value.address_four,this.PlanningForm.value.version_formation,this.PlanningForm.value.statut_f,this.filterSession[0].etat_session,n,this.filterSession[0].designation,this.PlanningForm.value.pays_formation,this.PlanningForm.value.contact_for,this.PlanningForm.value.numero_for,this.PlanningForm.value.mail_contact,this.PlanningForm.value.nbr_participant):yield this.envoyerEmailDistancielle(this.filterFormateur[0].email,this.PlanningForm.value.ref_formation,o(this.filterSession[0].date_debut).format("DD-MM-YYYY"),o(this.filterSession[0].date_fin).format("DD-MM-YYYY"),this.PlanningForm.value.type_formation,this.filterSession[0].langue,this.PlanningForm.value.version_formation,this.PlanningForm.value.statut_f,this.filterSession[0].etat_session,n,this.filterSession[0].designation,this.PlanningForm.value.contact_for,this.PlanningForm.value.numero_for,this.PlanningForm.value.mail_contact,this.PlanningForm.value.nbr_participant),this.toastr.success("Succ\xe8s"),this.router.navigate(["/admin/list-planning-cours-examen/planning-cours/list-planning-cours"])}else this.toastr.error("Erreur",n.error),this.isLoading=!1})))}onchange(t){t&&(this.displayType=!1,this.displayPays=!1,this.displayDate=!1,this.displayFormateur=!1,this.displayAddress=!1,this.versions=[],this.PlanningForm.patchValue({version_formation:"",type_formation:"",pays_formation:"",date_formation:"",name:"",address_four:""}),this.planningService.getAllDistinctVersionFormation(this.PlanningForm.value.ref_formation).subscribe(t=>{this.versions=t.results,null!==this.versions[0].version&&""!==this.versions[0].version?this.displayVersion=!0:(this.displayVersion=!1,this.withoutVersion())}))}withoutVersion(){this.displayType=!0,this.displayPays=!1,this.displayDate=!1,this.displayFormateur=!1,this.displayAddress=!1,this.types=[],this.PlanningForm.patchValue({type_formation:"",pays_formation:"",date_formation:"",name:"",address_four:""}),this.planningService.getAllDistinctTypeFormationWithoutVersion(this.PlanningForm.value.ref_formation).subscribe(t=>{this.types=t.results})}changeVersion(t){t&&(this.displayType=!0,this.displayPays=!1,this.displayDate=!1,this.displayFormateur=!1,this.displayAddress=!1,this.types=[],this.PlanningForm.patchValue({type_formation:"",pays_formation:"",date_formation:"",name:"",address_four:""}),this.planningService.getAllDistinctTypeFormation(this.PlanningForm.value.ref_formation,this.PlanningForm.value.version_formation).subscribe(t=>{this.types=t.results}))}changeType(t){t&&(this.pays=[],this.displayDate=!1,this.displayFormateur=!1,this.PlanningForm.patchValue({pays_formation:"",date_formation:"",name:"",address_four:""}),"pr\xe9sentielle"===this.PlanningForm.value.type_formation?(this.displayPays=!0,this.displayAddress=!0,this.PlanningForm.get("address_four").setValidators([g.u.required,this.trimValidator])):(this.PlanningForm.get("address_four").clearValidators(),this.displayPays=!1,this.displayAddress=!1,this.dates=[],this.displayDate=!0,this.PlanningForm.patchValue({pays_formation:"",date_formation:"",name:"",address_four:""}),null!==this.versions[0].version&&""!==this.versions[0].version?this.planningService.getAllDateFormationDistintDistienciellle(this.PlanningForm.value.ref_formation,this.PlanningForm.value.version_formation,this.PlanningForm.value.type_formation).subscribe(t=>{this.dates=t.results}):this.planningService.getAllDateFormationDistintDistienciellleWithoutVersion(this.PlanningForm.value.ref_formation,this.PlanningForm.value.type_formation).subscribe(t=>{this.dates=t.results})),null!==this.versions[0].version&&""!==this.versions[0].version?this.planningService.getAllDistinctPaysFormation(this.PlanningForm.value.ref_formation,this.PlanningForm.value.version_formation,this.PlanningForm.value.type_formation).subscribe(t=>{this.pays=t.results}):this.planningService.getAllDistinctPaysFormationWithoutVersion(this.PlanningForm.value.ref_formation,this.PlanningForm.value.type_formation).subscribe(t=>{this.pays=t.results}))}changePays(t){t&&(this.dates=[],this.displayDate=!0,this.displayFormateur=!1,this.PlanningForm.patchValue({date_formation:"",name:""}),null!==this.versions[0].version&&""!==this.versions[0].version?this.planningService.getAllDateFormationPresentielle(this.PlanningForm.value.ref_formation,this.PlanningForm.value.version_formation,this.PlanningForm.value.type_formation,this.PlanningForm.value.pays_formation).subscribe(t=>{this.dates=t.results}):this.planningService.getAllDateFormationPresentielleWithoutVersion(this.PlanningForm.value.ref_formation,this.PlanningForm.value.type_formation,this.PlanningForm.value.pays_formation).subscribe(t=>{this.dates=t.results}))}getIdSession(t){t&&(this.displayFormateur=!0,this.filterSession=[],this.filterSession=this.dates.filter(t=>Number(t.id)===Number(this.PlanningForm.value.date_formation)),this.PlanningForm.patchValue({name:""}),this.fetchFormateur())}fetchFormateur(){return Object(h.b)(this,void 0,void 0,(function*(){this.dataFormateurFilter=[],this.dataFormateur=[],this.schedule=[],this.formateur=[],this.dataAllFormateur=[],yield this.planningService.getAllAffecteSessionFormateur().subscribe(t=>Object(h.b)(this,void 0,void 0,(function*(){this.formateur=t.result,this.formateur&&this.formateur.forEach(t=>{t.schedule?(this.schedule=t.schedule.split(","),this.schedule.forEach(n=>{this.d=n.split("/"),o(this.filterSession[0].date_debut).format("YYYY-MM-DD")>=this.d[0]&&o(this.filterSession[0].date_debut).format("YYYY-MM-DD")<=this.d[1]||o(this.filterSession[0].date_fin).format("YYYY-MM-DD")>=this.d[0]&&o(this.filterSession[0].date_fin).format("YYYY-MM-DD")<=this.d[1]?this.dataFormateur.push(Object.assign(Object.assign({},t),{reserved:"R\xe9serv\xe9e par "+this.d[2]+" de "+this.d[0]+" -- "+this.d[1]})):this.dataFormateur.push(Object.assign(Object.assign({},t),{reservednot:!1}))})):this.dataFormateur.push(Object.assign(Object.assign({},t),{reservednot:!1})),this.schedule=[]});const n=this.dataFormateur.filter(t=>t.reserved),e=new Set,i=yield this.dataFormateur.filter(t=>{const n=e.has(t.id);return e.add(t.id),!n});this.dataFormateurFilter=[...n];let r=[];n.forEach(t=>{r.push(t.id)});let s=!1;i.forEach(t=>{s=!1;for(const n of r){if(t.id===n){s=!0;break}s=!1}s||this.dataFormateurFilter.push(t)}),r=[],this.dataFormateurFilter.forEach(t=>{r.push(t.id)}),this.formateurService.getAllFormateur().subscribe(t=>{this.dataAllFormateur=t.results,this.dataAllFormateur.forEach(t=>{s=!1;for(const n of r){if(t.id===n){s=!0;break}s=!1}s||this.dataFormateurFilter.push(t)})})})))}))}onchangeFournisseur(t){if(t){const t=this.PlanningForm.value.nom_four;this.fourn=this.fournisseur.filter(n=>n.nom_fournisseur===t),this.idFournisseur=this.fourn[0].id,this.PlanningForm.patchValue({address_four:""})}}getEmail(t){t&&(this.filterFormateur=this.dataAllFormateur.filter(t=>Number(t.id)===Number(this.PlanningForm.value.name)))}fetchRefFormation(){this.session=[],this.allref=[],this.filterallref=[],this.displayFormateur=!1,this.PlanningForm.patchValue({version_formation:"",ref_formation:"",type_formation:"",pays_formation:"",date_formation:"",name:""}),this.planningService.getAllDistinctRefFormation(this.PlanningForm.value.cat_formation).subscribe(t=>{this.session=t.results,this.coursService.getAllRefByCategories(this.PlanningForm.value.cat_formation).subscribe(t=>{this.allref=t.result;let n=!1;this.allref.length>0&&this.allref.forEach(t=>{n=!1;for(const e of this.session){if(t.ref_form==e.ref_form){n=!0;break}n=!1}n||this.filterallref.push(t)})})})}fetchFournisseur(){this.fornisseurService.getAllFournisseurWithoutAdress().subscribe(t=>{this.fournisseur=t.results})}affectedSession(t,n){this.sessionService.updateSessionAffected(t,n).subscribe(t=>{t.success||this.toastr.error("Error",t.error)})}envoyerEmail(t,n,e,i,r,o,s,a,c,l,u,d,f,m,b,h,g){this.sessionService.envoyerEmailFormateur(t,n,e,i,r,o,s,a,c,l,u,d,f,m,b,h,g).subscribe(t=>{t.success||this.toastr.error("Error",t.error)})}envoyerEmailDistancielle(t,n,e,i,r,o,s,a,c,l,u,d,f,m,b){this.sessionService.envoyerEmailFormateurTypeDistancielle(t,n,e,i,r,o,s,a,c,l,u,d,f,m,b).subscribe(t=>{t.success||this.toastr.error("Error",t.error)})}fetchCategorie(){this.categorieService.getAllCategories().subscribe(t=>{this.categories=t.results})}changeCatgory(t){t&&(this.displayRef=!0,this.displayVersion=!1,this.displayType=!1,this.displayPays=!1,this.displayDate=!1,this.displayFormateur=!1,this.PlanningForm.patchValue({ref_formation:"",version_formation:"",type_formation:"",pays_formation:"",date_formation:"",name:""}),this.fetchRefFormation())}}return t.\u0275fac=function(n){return new(n||t)(s.Vb(g.e),s.Vb(c.c),s.Vb(p.b),s.Vb(_.a),s.Vb(at.a),s.Vb(F.a),s.Vb(a.a),s.Vb(ct.a),s.Vb(v.a))},t.\u0275cmp=s.Pb({type:t,selectors:[["app-add-planning"]],decls:49,vars:42,consts:[[1,"content-wrapper"],[1,"content"],[1,"container-fluid"],[1,"text-right","mt-5",2,"padding-top","50px !important"],["routerLink","/admin/list-planning-cours-examen/planning-cours/list-planning-cours",1,"btn","btn-success","mr-2"],[1,"fas","fa-arrow-alt-circle-left"],[1,"row","mb-2"],[1,"col-sm-12","text-center","mb-4"],[1,"add-title"],[1,"col-12","col-md-6","mx-auto"],[3,"formGroup","ngSubmit"],[1,"input-group","mb-3"],["nzPlaceHolder","Choisir une cat\xe9gorie","formControlName","cat_formation",3,"nzNotFoundContent","ngClass","ngModelChange"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["class","invalid-feedback",4,"ngIf"],["class","input-group mb-3",4,"ngIf"],["nzAllowClear","","nzPlaceHolder","Choisir statut d'instructeur","formControlName","statut_f",3,"nzNotFoundContent","ngClass"],["nzLabel","En attente de confirmation","nzValue","En attente de confirmation"],["nzLabel","Confirm\xe9e","nzValue","Confirm\xe9e"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Choisir un fournisseur","formControlName","nom_four",3,"nzNotFoundContent","ngClass","ngModelChange"],["nz-input","","placeholder","Contact","formControlName","contact_for",3,"ngClass"],["nz-input","","placeholder","Num\xe9ro du contact","formControlName","numero_for",3,"ngClass"],["nz-input","","placeholder","Mail du contact","formControlName","mail_contact",3,"ngClass"],["nz-input","","placeholder","Nombre estim\xe9 des participants","formControlName","nbr_participant",3,"ngClass"],[1,"row"],[1,"col-12","mb-4","text-center"],["type","submit","nz-button","","nzType","primary","nzBlock","",3,"nzLoading"],[3,"nzLabel","nzValue"],[1,"invalid-feedback"],[4,"ngIf"],["nzShowSearch","","nzPlaceHolder","Choisir une r\xe9f\xe9rence","formControlName","ref_formation",3,"nzNotFoundContent","ngClass","ngModelChange"],["nzCustomContent","","nzDisabled","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nzCustomContent","","nzDisabled","",3,"nzLabel","nzValue"],["nz-tooltip","","nzTooltipPlacement","right","nzTooltipTitle","Pas de date"],["nzShowSearch","","nzPlaceHolder","Choisir une version","formControlName","version_formation",3,"nzNotFoundContent","ngClass","ngModelChange"],["nzShowSearch","","nzPlaceHolder","Choisir un type","formControlName","type_formation",3,"nzNotFoundContent","ngClass","ngModelChange"],["nzShowSearch","","nzPlaceHolder","Choisir un pays","formControlName","pays_formation",3,"nzNotFoundContent","ngClass","ngModelChange"],["nzShowSearch","","nzPlaceHolder","Choisir une date","formControlName","date_formation",3,"nzNotFoundContent","ngClass","ngModelChange"],["nzCustomContent","",3,"nzDisabled","nzLabel","nzValue",4,"ngFor","ngForOf"],["nzCustomContent","",3,"nzDisabled","nzLabel","nzValue"],["nz-tooltip","","nzTooltipPlacement","right",3,"nzTooltipTitle"],["nzShowSearch","","nzPlaceHolder","Choisir nom de l'instructeur","formControlName","name",3,"nzNotFoundContent","ngClass","ngModelChange"],["nz-input","","placeholder","Addresse","formControlName","address_four",3,"ngClass","nzAutosize"]],template:function(t,n){1&t&&(s.bc(0,"div",0),s.bc(1,"section",1),s.bc(2,"div",2),s.bc(3,"div",3),s.bc(4,"button",4),s.Wb(5,"i",5),s.Rc(6," Retour "),s.ac(),s.ac(),s.bc(7,"div",6),s.bc(8,"div",7),s.bc(9,"h1",8),s.Rc(10,"Ajouter une allocation d'instructeur"),s.ac(),s.ac(),s.bc(11,"div",9),s.bc(12,"form",10),s.mc("ngSubmit",(function(){return n.onSubmit()})),s.bc(13,"div",11),s.bc(14,"nz-select",12),s.mc("ngModelChange",(function(t){return n.changeCatgory(t)})),s.Pc(15,lt,1,2,"nz-option",13),s.ac(),s.Pc(16,dt,2,1,"div",14),s.ac(),s.Pc(17,pt,5,7,"div",15),s.Pc(18,zt,4,6,"div",15),s.Pc(19,wt,4,6,"div",15),s.Pc(20,Nt,4,6,"div",15),s.Pc(21,Vt,4,6,"div",15),s.Pc(22,At,4,6,"div",15),s.bc(23,"div",11),s.bc(24,"nz-select",16),s.Wb(25,"nz-option",17),s.Wb(26,"nz-option",18),s.ac(),s.Pc(27,Ot,2,1,"div",14),s.ac(),s.bc(28,"div",11),s.bc(29,"nz-select",19),s.mc("ngModelChange",(function(t){return n.onchangeFournisseur(t)})),s.Pc(30,qt,1,2,"nz-option",13),s.ac(),s.Pc(31,Bt,2,1,"div",14),s.ac(),s.Pc(32,Kt,3,6,"div",15),s.bc(33,"div",11),s.Wb(34,"input",20),s.Pc(35,Zt,4,3,"div",14),s.ac(),s.bc(36,"div",11),s.Wb(37,"input",21),s.Pc(38,tn,2,1,"div",14),s.ac(),s.bc(39,"div",11),s.Wb(40,"input",22),s.Pc(41,on,4,3,"div",14),s.ac(),s.bc(42,"div",11),s.Wb(43,"input",23),s.Pc(44,an,2,1,"div",14),s.ac(),s.bc(45,"div",24),s.bc(46,"div",25),s.bc(47,"button",26),s.Rc(48,"Enregistrer"),s.ac(),s.ac(),s.ac(),s.ac(),s.ac(),s.ac(),s.ac(),s.ac(),s.ac()),2&t&&(s.Hb(12),s.wc("formGroup",n.PlanningForm),s.Hb(2),s.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",s.Bc(28,gt,n.submitted&&n.f.cat_formation.errors)),s.Hb(1),s.wc("ngForOf",n.categories),s.Hb(1),s.wc("ngIf",n.submitted&&n.f.cat_formation.errors),s.Hb(1),s.wc("ngIf",n.displayRef),s.Hb(1),s.wc("ngIf",n.displayVersion),s.Hb(1),s.wc("ngIf",n.displayType),s.Hb(1),s.wc("ngIf",n.displayPays),s.Hb(1),s.wc("ngIf",n.displayDate),s.Hb(1),s.wc("ngIf",n.displayFormateur),s.Hb(2),s.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",s.Bc(30,gt,n.submitted&&n.f.statut_f.errors)),s.Hb(3),s.wc("ngIf",n.submitted&&n.f.statut_f.errors),s.Hb(2),s.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",s.Bc(32,gt,n.submitted&&n.f.nom_four.errors)),s.Hb(1),s.wc("ngForOf",n.fournisseur),s.Hb(1),s.wc("ngIf",n.submitted&&n.f.nom_four.errors),s.Hb(1),s.wc("ngIf",n.displayAddress),s.Hb(2),s.wc("ngClass",s.Bc(34,gt,n.submitted&&n.f.contact_for.errors)),s.Hb(1),s.wc("ngIf",n.submitted&&n.f.contact_for.errors),s.Hb(2),s.wc("ngClass",s.Bc(36,gt,n.submitted&&n.f.numero_for.errors)),s.Hb(1),s.wc("ngIf",n.submitted&&n.f.numero_for.errors),s.Hb(2),s.wc("ngClass",s.Bc(38,gt,n.submitted&&n.f.mail_contact.errors)),s.Hb(1),s.wc("ngIf",n.submitted&&n.f.mail_contact.errors),s.Hb(2),s.wc("ngClass",s.Bc(40,gt,n.submitted&&n.f.nbr_participant.errors)),s.Hb(1),s.wc("ngIf",n.submitted&&n.f.nbr_participant.errors),s.Hb(3),s.wc("nzLoading",n.isLoading))},directives:[c.d,g.w,g.n,g.h,z.b,g.m,g.g,i.l,i.m,i.n,z.a,P.b,g.d,R.a,C.a,w.a,H.b,P.a],pipes:[i.e],styles:["@media(max-width:768px){.add-title[_ngcontent-%COMP%]{font-size:1.5rem;margin-top:50px}.form-control[_ngcontent-%COMP%]{font-size:.8rem!important}}@media(min-width:768px){.add-title[_ngcontent-%COMP%]{font-size:2.1rem;margin-top:40px}}nz-select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{width:100%}"]}),t})();var ln=e("Bby8"),un=e("mFeF");function dn(t,n){1&t&&(s.bc(0,"div"),s.Rc(1," cat\xe9gorie est obligatoire "),s.ac())}function fn(t,n){if(1&t&&(s.bc(0,"div",34),s.Pc(1,dn,2,0,"div",35),s.ac()),2&t){const t=s.pc();s.Hb(1),s.wc("ngIf",t.f.cat_formation.errors.required)}}function mn(t,n){1&t&&(s.bc(0,"div"),s.Rc(1," R\xe9f\xe9rence est obligatoire "),s.ac())}function bn(t,n){if(1&t&&(s.bc(0,"div",34),s.Pc(1,mn,2,0,"div",35),s.ac()),2&t){const t=s.pc();s.Hb(1),s.wc("ngIf",t.f.ref_formation.errors.required)}}function hn(t,n){if(1&t&&(s.bc(0,"div",11),s.bc(1,"nz-select",36),s.Wb(2,"nz-option",13),s.ac(),s.ac()),2&t){const t=s.pc();s.Hb(1),s.wc("nzNotFoundContent","Pas de r\xe9sultat"),s.Hb(1),s.xc("nzLabel",null==t.Result?null:t.Result.version),s.wc("nzValue",null==t.Result?null:t.Result.version)}}function gn(t,n){1&t&&(s.bc(0,"div"),s.Rc(1," date est obligatoire "),s.ac())}function pn(t,n){if(1&t&&(s.bc(0,"div",34),s.Pc(1,gn,2,0,"div",35),s.ac()),2&t){const t=s.pc();s.Hb(1),s.wc("ngIf",t.f.date_formation.errors.required)}}function vn(t,n){if(1&t&&(s.bc(0,"nz-option",37),s.bc(1,"span",38),s.Rc(2),s.ac(),s.ac()),2&t){const t=n.$implicit;s.zc("nzLabel","",t.nom," ",t.prenom,""),s.xc("nzValue",t.id),s.wc("nzDisabled",t.reserved),s.Hb(1),s.wc("nzTooltipTitle",t.reserved?t.reserved:""),s.Hb(1),s.Uc(" ",t.nom," ",t.prenom," ")}}function _n(t,n){1&t&&(s.bc(0,"div"),s.Rc(1," nom de l'instructeur est obligatoire "),s.ac())}function Fn(t,n){if(1&t&&(s.bc(0,"div",34),s.Pc(1,_n,2,0,"div",35),s.ac()),2&t){const t=s.pc();s.Hb(1),s.wc("ngIf",t.f.name.errors.required)}}function zn(t,n){1&t&&(s.bc(0,"div"),s.Rc(1," statut d'instructeur est obligatoire "),s.ac())}function Pn(t,n){if(1&t&&(s.bc(0,"div",34),s.Pc(1,zn,2,0,"div",35),s.ac()),2&t){const t=s.pc();s.Hb(1),s.wc("ngIf",t.f.statut_f.errors.required)}}function Rn(t,n){if(1&t&&s.Wb(0,"nz-option",13),2&t){const t=n.$implicit;s.xc("nzLabel",t.nom_fournisseur),s.wc("nzValue",t.nom_fournisseur)}}function Cn(t,n){1&t&&(s.bc(0,"div"),s.Rc(1," Nom du fournisseur est obligatoire "),s.ac())}function wn(t,n){if(1&t&&(s.bc(0,"div",34),s.Pc(1,Cn,2,0,"div",35),s.ac()),2&t){const t=s.pc();s.Hb(1),s.wc("ngIf",t.f.nom_four.errors.required)}}function Hn(t,n){1&t&&(s.bc(0,"div"),s.Rc(1," Contact est obligatoire "),s.ac())}function yn(t,n){1&t&&(s.bc(0,"div"),s.Rc(1," Contact est invalide "),s.ac())}function Sn(t,n){1&t&&(s.bc(0,"div"),s.Rc(1," Contact est invalide "),s.ac())}function Nn(t,n){if(1&t&&(s.bc(0,"div",34),s.Pc(1,Hn,2,0,"div",35),s.Pc(2,yn,2,0,"div",35),s.Pc(3,Sn,2,0,"div",35),s.ac()),2&t){const t=s.pc();s.Hb(1),s.wc("ngIf",t.f.contact_for.errors.required),s.Hb(1),s.wc("ngIf",t.f.contact_for.errors.trimError),s.Hb(1),s.wc("ngIf",t.f.contact_for.errors.trimError2)}}function In(t,n){1&t&&(s.bc(0,"div"),s.Rc(1," Num\xe9ro du contact est obligatoire "),s.ac())}function Mn(t,n){if(1&t&&(s.bc(0,"div",34),s.Pc(1,In,2,0,"div",35),s.ac()),2&t){const t=s.pc();s.Hb(1),s.wc("ngIf",t.f.numero_for.errors.required)}}function Yn(t,n){1&t&&(s.bc(0,"div"),s.Rc(1," Mail du contact est obligatoire "),s.ac())}function Vn(t,n){1&t&&(s.bc(0,"div"),s.Rc(1," Mail du contact est invalide "),s.ac())}function Dn(t,n){1&t&&(s.bc(0,"div"),s.Rc(1," Mail du contact est invalide "),s.ac())}function xn(t,n){if(1&t&&(s.bc(0,"div",34),s.Pc(1,Yn,2,0,"div",35),s.Pc(2,Vn,2,0,"div",35),s.Pc(3,Dn,2,0,"div",35),s.ac()),2&t){const t=s.pc();s.Hb(1),s.wc("ngIf",t.f.mail_contact.errors.required),s.Hb(1),s.wc("ngIf",t.f.mail_contact.errors.trimError),s.Hb(1),s.wc("ngIf",t.f.mail_contact.errors.trimError2)}}function En(t,n){1&t&&(s.bc(0,"div"),s.Rc(1," Nombre estim\xe9 des participants est obligatoire "),s.ac())}function An(t,n){if(1&t&&(s.bc(0,"div",34),s.Pc(1,En,2,0,"div",35),s.ac()),2&t){const t=s.pc();s.Hb(1),s.wc("ngIf",t.f.nbr_participant.errors.required)}}const Ln=function(t){return{"is-invalid":t}},On=[{path:"",component:(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=s.Pb({type:t,selectors:[["app-planning"]],decls:1,vars:0,template:function(t,n){1&t&&s.Wb(0,"router-outlet")},directives:[c.h],styles:[""]}),t})(),children:[{path:"list-planning",component:un.a},{path:"list-planning-inactive",component:ln.a},{path:"add-planning",component:cn},{path:"edit-planning/:id",component:st},{path:"update-planning/:id",component:(()=>{class t{constructor(t,n,e,i,r,o,s,a){this.formBuilder=t,this.router=n,this.toastr=e,this.formateurService=i,this.sessionService=r,this.fornisseurService=o,this.planningService=s,this.route=a,this.submitted=!1,this.formateur=[],this.session=[],this.displayAddress=!1,this.displayVersion=!1,this.filtercours=[],this.fournisseur=[],this.addresses=[],this.dates=[],this.filterAddress=[],this.schedule=[],this.dataFormateur=[],this.d=[],this.dataAllFormateur=[],this.dataFormateurFilter=[],this.dataFormateurFil=[],this.mobile=!1,this.isLoading=!1}ngOnInit(){return Object(h.b)(this,void 0,void 0,(function*(){window.screen.width<768&&(this.mobile=!0),this.id=this.route.snapshot.paramMap.get("id"),this.dateToday=o(new Date).format("YYYY-MM-DD"),this.PlanningForm=this.formBuilder.group({name:["",[g.u.required]],statut_f:["",[g.u.required]],cat_formation:[""],version_formation:[""],type_formation:[""],ref_formation:[""],date_formation:[""],nom_four:["",[g.u.required]],nbr_participant:["",[g.u.required]],numero_for:["",[g.u.required]],mail_contact:["",[g.u.required]],contact_for:["",[g.u.required]]}),yield this.planningService.getPlanningById(this.id).subscribe(t=>{this.Result=t.result[0],this.PlanningForm.patchValue({name:this.Result.name,cat_formation:this.Result.categorie,ref_formation:this.Result.ref_formation,version_formation:this.Result.version,type_formation:this.Result.type,date_formation:`${o(this.Result.date_debut).format("DD-MM-YYYY")} / ${o(this.Result.fin).format("DD-MM-YYYY")}`,statut_f:this.Result.statut_f,nom_four:this.Result.nom_fournisseur,numero_for:this.Result.numero_for,contact_for:this.Result.contact_for,mail_contact:this.Result.mail_contact,nbr_participant:this.Result.nbr_participant}),this.Result.date_formation=`${o(this.Result.date_debut).format("DD-MM-YYYY")} / ${o(this.Result.fin).format("DD-MM-YYYY")}`,null!==this.Result.version&&""!==this.Result.version&&(this.displayVersion=!0),this.fetchFormateur(),this.fetchFournisseur()})}))}get f(){return this.PlanningForm.controls}onSubmit(){if(this.submitted=!0,this.PlanningForm.invalid)return;this.isLoading=!0;const t={id_formateur:this.filterFormateur[0].id,statut_f:this.PlanningForm.value.statut_f,id_fournisseur:this.idFournisseur,id_address_fournisseur:null,nbr_participant:this.PlanningForm.value.nbr_participant,numero_for:this.PlanningForm.value.numero_for,mail_contact:this.PlanningForm.value.mail_contact,contact_for:this.PlanningForm.value.contact_for};this.dateToday<o(this.Result.date_fin).format("YYYY-MM-DD")&&this.planningService.updatePlanning(this.id,t).subscribe(n=>Object(h.b)(this,void 0,void 0,(function*(){if(n.success){null!==this.Result.version&&""!==this.Result.version||(this.Result.version=null),this.filterFormateur[0].id!==this.Result.id_formateur&&this.sessionService.emailFormateurChanger(this.Result.email,this.Result.name,this.Result.ref_formation,this.Result.designation,o(this.Result.date_debut).format("DD-MM-YYYY"),o(this.Result.date_fin).format("DD-MM-YYYY")).subscribe(t=>{t.success||this.toastr.error("Erreur",t.error)}),yield this.affectedSession(this.Result.id_session,t.id_formateur);const n=this.filterFormateur[0].nom+" "+this.filterFormateur[0].prenom;yield this.envoyerEmailDistancielle(this.filterFormateur[0].email,this.Result.ref_formation,o(this.Result.date_debut).format("DD-MM-YYYY"),o(this.Result.date_fin).format("DD-MM-YYYY"),this.Result.type,this.Result.langue,this.Result.version,t.statut_f,this.Result.etat_session,n,this.Result.designation,t.contact_for,t.numero_for,t.mail_contact,t.nbr_participant),this.toastr.success("Succ\xe8s"),this.router.navigate(["/admin/list-planning-cours-examen/planning-cours/list-planning-cours"])}else this.toastr.error("Erreur",n.error),this.isLoading=!1})))}fetchFormateur(){return Object(h.b)(this,void 0,void 0,(function*(){this.dataFormateurFilter=[],this.dataFormateur=[],this.schedule=[],this.formateur=[],this.dataAllFormateur=[],yield this.planningService.getAllAffecteSessionFormateur().subscribe(t=>Object(h.b)(this,void 0,void 0,(function*(){this.formateur=t.result,this.formateur.forEach(t=>{t.schedule?(this.schedule=t.schedule.split(","),this.schedule.forEach(n=>{this.d=n.split("/"),o(this.Result.date_debut).isBetween(this.d[0],this.d[1],void 0,"[]")||o(this.Result.date_fin).isBetween(this.d[0],this.d[1],void 0,"[]")?this.dataFormateur.push(Object.assign(Object.assign({},t),{reserved:"R\xe9serv\xe9e par "+this.d[2]+" de "+this.d[0]+" -- "+this.d[1]})):this.dataFormateur.push(Object.assign(Object.assign({},t),{reservednot:!1}))})):this.dataFormateur.push(Object.assign(Object.assign({},t),{reservednot:!1})),this.schedule=[]});const n=this.dataFormateur.filter(t=>t.reserved),e=new Set,i=yield this.dataFormateur.filter(t=>{const n=e.has(t.id);return e.add(t.id),!n});this.dataFormateurFilter=[...n];let r=[];n.forEach(t=>{r.push(t.id)});let s=!1;i.forEach(t=>{s=!1;for(const n of r){if(t.id===n){s=!0;break}s=!1}s||this.dataFormateurFilter.push(t)}),r=[],this.dataFormateurFilter.forEach(t=>{r.push(t.id)}),this.formateurService.getAllFormateur().subscribe(t=>{this.dataAllFormateur=t.results,this.dataAllFormateur.forEach(t=>{s=!1;for(const n of r){if(t.id===n){s=!0;break}s=!1}s||this.dataFormateurFilter.push(t)}),this.dataFormateurFil=this.dataFormateurFilter.filter(t=>Number(t.id)!==Number(this.Result.id_formateur)),this.defaultGetEmail()})})))}))}changeFournisseurDefault(){if(null!==this.Result.nom_fournisseur){const t=this.PlanningForm.value.nom_four;this.fourn=this.fournisseur.filter(n=>n.nom_fournisseur===t),this.idFournisseur=this.fourn[0].id}}onchangeFournisseur(t){if(t&&this.PlanningForm.value.nom_four){this.submitted=!1;const t=this.PlanningForm.value.nom_four;this.fourn=this.fournisseur.filter(n=>n.nom_fournisseur===t),this.idFournisseur=this.fourn[0].id}}getEmail(t){t&&this.PlanningForm.value.name&&(this.filterFormateur=[],this.filterFormateur=this.dataFormateurFilter.filter(t=>Number(t.id)===Number(this.PlanningForm.value.name)))}defaultGetEmail(){this.filterFormateur=[],this.filterFormateur=this.dataFormateurFilter.filter(t=>Number(t.id)===this.Result.id_formateur)}fetchFournisseur(){this.fornisseurService.getAllFournisseurWithoutAdress().subscribe(t=>{this.fournisseur=t.results,this.changeFournisseurDefault()})}affectedSession(t,n){this.sessionService.updateSessionAffected(t,n).subscribe(t=>{t.success||this.toastr.error("Erreur",t.error)})}envoyerEmailDistancielle(t,n,e,i,r,o,s,a,c,l,u,d,f,m,b){this.sessionService.envoyerEmailFormateurTypeDistancielle(t,n,e,i,r,o,s,a,c,l,u,d,f,m,b).subscribe(t=>{t.success||this.toastr.error("Erreur",t.error)})}}return t.\u0275fac=function(n){return new(n||t)(s.Vb(g.e),s.Vb(c.c),s.Vb(p.b),s.Vb(v.a),s.Vb(_.a),s.Vb(F.a),s.Vb(a.a),s.Vb(c.a))},t.\u0275cmp=s.Pb({type:t,selectors:[["app-update-plannig"]],decls:61,vars:64,consts:[[1,"content-wrapper"],[1,"content"],[1,"container-fluid"],[1,"text-right","mt-5",2,"padding-top","50px !important"],["routerLink","/admin/list-planning-cours-examen/planning-cours/list-planning-cours",1,"btn","btn-success","mr-2"],[1,"fas","fa-arrow-alt-circle-left"],[1,"row","mb-2"],[1,"col-sm-12","text-center","mb-4"],[1,"edit-title"],[1,"col-12","col-md-6","mx-auto"],[3,"formGroup","ngSubmit"],[1,"input-group","mb-3"],["nzPlaceHolder","Choisir une cat\xe9gorie","formControlName","cat_formation",3,"nzNotFoundContent","ngClass"],[3,"nzLabel","nzValue"],["class","invalid-feedback",4,"ngIf"],["nzPlaceHolder","Choisir une r\xe9f\xe9rence","formControlName","ref_formation",3,"nzNotFoundContent","ngClass"],["class","input-group mb-3",4,"ngIf"],["nzPlaceHolder","Choisir un type","formControlName","type_formation",3,"nzNotFoundContent"],["nzPlaceHolder","Choisir une date","formControlName","date_formation",3,"nzNotFoundContent","ngClass"],["nzShowSearch","","nzPlaceHolder","Choisir nom de l'instructeur","formControlName","name",3,"nzNotFoundContent","ngClass","ngModelChange"],["nzCustomContent","",3,"nzDisabled","nzLabel","nzValue",4,"ngFor","ngForOf"],["nzAllowClear","","nzPlaceHolder","Choisir statut d'instructeur","formControlName","statut_f",3,"nzNotFoundContent","ngClass"],["nzLabel","En attente de confirmation","nzValue","En attente de confirmation"],["nzLabel","Confirm\xe9e","nzValue","Confirm\xe9e"],["nzLabel","Annul\xe9e","nzValue","annul\xe9e"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Choisir un fournisseur","formControlName","nom_four",3,"nzNotFoundContent","ngClass","ngModelChange"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nz-input","","placeholder","Contact","formControlName","contact_for",3,"ngClass"],["nz-input","","placeholder","Num\xe9ro du contact","formControlName","numero_for",3,"ngClass"],["nz-input","","placeholder","Mail du contact","formControlName","mail_contact",3,"ngClass"],["nz-input","","placeholder","Nombre estim\xe9 des participants","formControlName","nbr_participant",3,"ngClass"],[1,"row"],[1,"col-12","mb-4","text-center"],["type","submit","nz-button","","nzType","primary","nzBlock","",3,"nzLoading"],[1,"invalid-feedback"],[4,"ngIf"],["nzPlaceHolder","Choisir une version","formControlName","version_formation",3,"nzNotFoundContent"],["nzCustomContent","",3,"nzDisabled","nzLabel","nzValue"],["nz-tooltip","","nzTooltipPlacement","right",3,"nzTooltipTitle"]],template:function(t,n){1&t&&(s.bc(0,"div",0),s.bc(1,"section",1),s.bc(2,"div",2),s.bc(3,"div",3),s.bc(4,"button",4),s.Wb(5,"i",5),s.Rc(6," Retour "),s.ac(),s.ac(),s.bc(7,"div",6),s.bc(8,"div",7),s.bc(9,"h1",8),s.Rc(10,"Modifier une allocation d'instructeur"),s.ac(),s.ac(),s.bc(11,"div",9),s.bc(12,"form",10),s.mc("ngSubmit",(function(){return n.onSubmit()})),s.bc(13,"div",11),s.bc(14,"nz-select",12),s.Wb(15,"nz-option",13),s.ac(),s.Pc(16,fn,2,1,"div",14),s.ac(),s.bc(17,"div",11),s.bc(18,"nz-select",15),s.Wb(19,"nz-option",13),s.ac(),s.Pc(20,bn,2,1,"div",14),s.ac(),s.Pc(21,hn,3,3,"div",16),s.bc(22,"div",11),s.bc(23,"nz-select",17),s.Wb(24,"nz-option",13),s.qc(25,"titlecase"),s.ac(),s.ac(),s.bc(26,"div",11),s.bc(27,"nz-select",18),s.Wb(28,"nz-option",13),s.ac(),s.Pc(29,pn,2,1,"div",14),s.ac(),s.bc(30,"div",11),s.bc(31,"nz-select",19),s.mc("ngModelChange",(function(t){return n.getEmail(t)})),s.Wb(32,"nz-option",13),s.Pc(33,vn,3,7,"nz-option",20),s.ac(),s.Pc(34,Fn,2,1,"div",14),s.ac(),s.bc(35,"div",11),s.bc(36,"nz-select",21),s.Wb(37,"nz-option",22),s.Wb(38,"nz-option",23),s.Wb(39,"nz-option",24),s.ac(),s.Pc(40,Pn,2,1,"div",14),s.ac(),s.bc(41,"div",11),s.bc(42,"nz-select",25),s.mc("ngModelChange",(function(t){return n.onchangeFournisseur(t)})),s.Pc(43,Rn,1,2,"nz-option",26),s.ac(),s.Pc(44,wn,2,1,"div",14),s.ac(),s.bc(45,"div",11),s.Wb(46,"input",27),s.Pc(47,Nn,4,3,"div",14),s.ac(),s.bc(48,"div",11),s.Wb(49,"input",28),s.Pc(50,Mn,2,1,"div",14),s.ac(),s.bc(51,"div",11),s.Wb(52,"input",29),s.Pc(53,xn,4,3,"div",14),s.ac(),s.bc(54,"div",11),s.Wb(55,"input",30),s.Pc(56,An,2,1,"div",14),s.ac(),s.bc(57,"div",31),s.bc(58,"div",32),s.bc(59,"button",33),s.Rc(60,"Enregistrer"),s.ac(),s.ac(),s.ac(),s.ac(),s.ac(),s.ac(),s.ac(),s.ac(),s.ac()),2&t&&(s.Hb(12),s.wc("formGroup",n.PlanningForm),s.Hb(2),s.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",s.Bc(44,Ln,n.submitted&&n.f.cat_formation.errors)),s.Hb(1),s.xc("nzLabel",null==n.Result?null:n.Result.categorie),s.wc("nzValue",null==n.Result?null:n.Result.categorie),s.Hb(1),s.wc("ngIf",n.submitted&&n.f.cat_formation.errors),s.Hb(2),s.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",s.Bc(46,Ln,n.submitted&&n.f.ref_formation.errors)),s.Hb(1),s.xc("nzLabel",null==n.Result?null:n.Result.ref_formation),s.wc("nzValue",null==n.Result?null:n.Result.ref_formation),s.Hb(1),s.wc("ngIf",n.submitted&&n.f.ref_formation.errors),s.Hb(1),s.wc("ngIf",n.displayVersion),s.Hb(2),s.wc("nzNotFoundContent","Pas de r\xe9sultat"),s.Hb(1),s.xc("nzLabel",s.rc(25,42,null==n.Result?null:n.Result.type)),s.wc("nzValue",null==n.Result?null:n.Result.type),s.Hb(3),s.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",s.Bc(48,Ln,n.submitted&&n.f.date_formation.errors)),s.Hb(1),s.xc("nzLabel",null==n.Result?null:n.Result.date_formation),s.xc("nzValue",null==n.Result?null:n.Result.date_formation),s.Hb(1),s.wc("ngIf",n.submitted&&n.f.date_formation.errors),s.Hb(2),s.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",s.Bc(50,Ln,n.submitted&&n.f.name.errors)),s.Hb(1),s.xc("nzLabel",null==n.Result?null:n.Result.name),s.wc("nzValue",null==n.Result?null:n.Result.name),s.Hb(1),s.wc("ngForOf",n.dataFormateurFil),s.Hb(1),s.wc("ngIf",n.submitted&&n.f.name.errors),s.Hb(2),s.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",s.Bc(52,Ln,n.submitted&&n.f.statut_f.errors)),s.Hb(4),s.wc("ngIf",n.submitted&&n.f.statut_f.errors),s.Hb(2),s.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",s.Bc(54,Ln,n.submitted&&n.f.nom_four.errors)),s.Hb(1),s.wc("ngForOf",n.fournisseur),s.Hb(1),s.wc("ngIf",n.submitted&&n.f.nom_four.errors),s.Hb(2),s.wc("ngClass",s.Bc(56,Ln,n.submitted&&n.f.contact_for.errors)),s.Hb(1),s.wc("ngIf",n.submitted&&n.f.contact_for.errors),s.Hb(2),s.wc("ngClass",s.Bc(58,Ln,n.submitted&&n.f.numero_for.errors)),s.Hb(1),s.wc("ngIf",n.submitted&&n.f.numero_for.errors),s.Hb(2),s.wc("ngClass",s.Bc(60,Ln,n.submitted&&n.f.mail_contact.errors)),s.Hb(1),s.wc("ngIf",n.submitted&&n.f.mail_contact.errors),s.Hb(2),s.wc("ngClass",s.Bc(62,Ln,n.submitted&&n.f.nbr_participant.errors)),s.Hb(1),s.wc("ngIf",n.submitted&&n.f.nbr_participant.errors),s.Hb(3),s.wc("nzLoading",n.isLoading))},directives:[c.d,g.w,g.n,g.h,z.b,g.m,g.g,i.l,z.a,i.n,i.m,P.b,g.d,R.a,C.a,w.a,H.b],pipes:[i.x],styles:["@media(max-width:768px){.edit-title[_ngcontent-%COMP%]{font-size:1.5rem;margin-top:50px}.form-control[_ngcontent-%COMP%]{font-size:.8rem!important}}@media(min-width:768px){.add-title[_ngcontent-%COMP%]{font-size:2rem;margin-top:40px}}nz-select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{width:100%}"]}),t})()},{path:"show-planning/:id",component:b},{path:"planning-calendar",component:r.a}]}];let qn=(()=>{class t{}return t.\u0275mod=s.Tb({type:t}),t.\u0275inj=s.Sb({factory:function(n){return new(n||t)},imports:[[c.g.forChild(On)],c.g]}),t})();var Wn=e("cZdB"),Bn=e("oOf3"),Tn=e("1kSV"),jn=e("IvIE"),kn=e("rMZv"),$n=e("PN1e"),Gn=e("ogxq"),Kn=e("lVl8"),Un=e("OtHt");jn.b.registerPlugins([$n.a,Gn.a]);let Jn=(()=>{class t{}return t.\u0275mod=s.Tb({type:t}),t.\u0275inj=s.Sb({factory:function(n){return new(n||t)},imports:[[i.c,qn,g.i,g.s,Wn.b,Bn.a,Tn.d,jn.b,H.a,R.c,kn.d,P.c,Kn.a,Un.b,z.c]]}),t})()}}]);