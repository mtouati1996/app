(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{qAH8:function(e,s,t){"use strict";t.r(s),t.d(s,"SessionModule",(function(){return Ie}));var i=t("ofXK"),n=t("DZv2"),o=t("wd/R"),r=t("fXoL"),c=t("la+k"),a=t("tyNb");function l(e,s){1&e&&(r.bc(0,"button",14),r.Wb(1,"i",15),r.Rc(2," Retour "),r.ac())}function u(e,s){1&e&&(r.bc(0,"button",16),r.Wb(1,"i",15),r.Rc(2," Retour "),r.ac())}function d(e,s){if(1&e&&(r.bc(0,"p",12),r.Rc(1,"Version: "),r.bc(2,"b"),r.Rc(3),r.ac(),r.ac()),2&e){const e=r.pc();r.Hb(3),r.Tc(" ",null==e.Results?null:e.Results.version_session,"")}}function b(e,s){if(1&e&&(r.bc(0,"p",12),r.Rc(1,"Instructeur : "),r.bc(2,"b"),r.Rc(3),r.ac(),r.ac()),2&e){const e=r.pc();r.Hb(3),r.Tc(" ",null==e.Results?null:e.Results.name,"")}}function f(e,s){if(1&e&&(r.bc(0,"p",12),r.Rc(1,"Pays: "),r.bc(2,"b"),r.Rc(3),r.qc(4,"titlecase"),r.ac(),r.ac()),2&e){const e=r.pc();r.Hb(3),r.Tc(" ",r.rc(4,1,null==e.Results?null:e.Results.lieu)," ")}}let m=(()=>{class e{constructor(e,s){this.sessionService=e,this.route=s}ngOnInit(){this.dateYestarday=o(new Date).add(-1,"days").format("YYYY-MM-DD"),this.id=this.route.snapshot.paramMap.get("id"),this.sessionService.getSessionWithEmailById(this.id).subscribe(e=>{this.Results=e.result[0]})}}return e.\u0275fac=function(s){return new(s||e)(r.Vb(c.a),r.Vb(a.a))},e.\u0275cmp=r.Pb({type:e,selectors:[["app-show-session"]],decls:48,vars:22,consts:[[1,"content-wrapper"],[1,"content"],[1,"container-fluid"],[1,"text-right","mt-5",2,"padding-top","50px !important"],["routerLink","/admin/list-session-cours-examen/session-cours/list-cours","class","btn btn-success mr-2",4,"ngIf"],["routerLink","/admin/list-session-cours-examen-inactive/session-cours/list-cours-inactive","class","btn btn-success mr-2",4,"ngIf"],[1,"row","mb-2","mt-4"],[1,"col-12","col-sm-6","col-md-12","col-lg-12"],[1,"card","bg-light"],[1,"card-body","pt-5"],[1,"row"],[1,"col-12"],[1,"lead","text-muted"],["class","lead text-muted",4,"ngIf"],["routerLink","/admin/list-session-cours-examen/session-cours/list-cours",1,"btn","btn-success","mr-2"],[1,"fas","fa-arrow-alt-circle-left"],["routerLink","/admin/list-session-cours-examen-inactive/session-cours/list-cours-inactive",1,"btn","btn-success","mr-2"]],template:function(e,s){1&e&&(r.bc(0,"div",0),r.bc(1,"section",1),r.bc(2,"div",2),r.bc(3,"div",3),r.Pc(4,l,3,0,"button",4),r.Pc(5,u,3,0,"button",5),r.ac(),r.bc(6,"div",6),r.bc(7,"div",7),r.bc(8,"div",8),r.bc(9,"div",9),r.bc(10,"div",10),r.bc(11,"div",11),r.bc(12,"p",12),r.Rc(13," R\xe9f\xe9rence: "),r.bc(14,"b"),r.Rc(15),r.ac(),r.ac(),r.Pc(16,d,4,1,"p",13),r.bc(17,"p",12),r.Rc(18,"Dur\xe9e: "),r.bc(19,"b"),r.Rc(20),r.ac(),r.ac(),r.Pc(21,b,4,1,"p",13),r.bc(22,"p",12),r.Rc(23,"Date de d\xe9but: "),r.bc(24,"b"),r.Rc(25),r.qc(26,"date"),r.ac(),r.ac(),r.bc(27,"p",12),r.Rc(28,"Date de fin: "),r.bc(29,"b"),r.Rc(30),r.qc(31,"date"),r.ac(),r.ac(),r.bc(32,"p",12),r.Rc(33,"Type: "),r.bc(34,"b"),r.Rc(35),r.qc(36,"titlecase"),r.ac(),r.ac(),r.bc(37,"p",12),r.Rc(38,"Langue: "),r.bc(39,"b"),r.Rc(40),r.qc(41,"titlecase"),r.ac(),r.ac(),r.Pc(42,f,5,3,"p",13),r.bc(43,"p",12),r.Rc(44,"Statut de session: "),r.bc(45,"b"),r.Rc(46),r.qc(47,"titlecase"),r.ac(),r.ac(),r.ac(),r.ac(),r.ac(),r.ac(),r.ac(),r.ac(),r.ac(),r.ac(),r.ac()),2&e&&(r.Hb(4),r.wc("ngIf",(null==s.Results?null:s.Results.date_fin)>s.dateYestarday),r.Hb(1),r.wc("ngIf",(null==s.Results?null:s.Results.date_fin)<s.dateYestarday),r.Hb(10),r.Sc(null==s.Results?null:s.Results.ref_formation),r.Hb(1),r.wc("ngIf",null==s.Results?null:s.Results.version_session),r.Hb(4),r.Tc(" ",null==s.Results?null:s.Results.duree,""),r.Hb(1),r.wc("ngIf",null==s.Results?null:s.Results.affecter),r.Hb(4),r.Tc(" ",r.rc(26,12,null==s.Results?null:s.Results.date_debut),""),r.Hb(5),r.Tc(" ",r.rc(31,14,null==s.Results?null:s.Results.date_fin)," "),r.Hb(5),r.Tc(" ",r.rc(36,16,null==s.Results?null:s.Results.type),""),r.Hb(5),r.Tc(" ",r.rc(41,18,null==s.Results?null:s.Results.langue)," "),r.Hb(2),r.wc("ngIf",null==s.Results?null:s.Results.lieu),r.Hb(4),r.Tc(" ",r.rc(47,20,null==s.Results?null:s.Results.etat_session)," "))},directives:[i.n,a.d],pipes:[i.e,i.x],styles:[".lead[_ngcontent-%COMP%]{font-size:.9rem;font-weight:300}@media(max-width:768px){.lead[_ngcontent-%COMP%]{font-size:.8rem}}"]}),e})();var h=t("sWXM"),g=t("AMcm");let p=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(s){return new(s||e)},e.\u0275cmp=r.Pb({type:e,selectors:[["app-session"]],decls:1,vars:0,template:function(e,s){1&e&&r.Wb(0,"router-outlet")},directives:[a.h],styles:[""]}),e})();var v=t("3Pt+"),z=t("3WhB"),C=t("5eHb"),y=t("LWzD"),_=t("Cxpb"),S=t("zAKX"),w=t("1kSV"),F=t("OzZK"),R=t("RwU8"),P=t("C2AL");function H(e,s){if(1&e&&r.Wb(0,"nz-option",35),2&e){const e=s.$implicit;r.xc("nzLabel",e.nom_categorie),r.wc("nzValue",e.nom_categorie)}}function V(e,s){1&e&&(r.bc(0,"div"),r.Rc(1,"cat\xe9gorie est obligatoire"),r.ac())}function D(e,s){if(1&e&&(r.bc(0,"div",36),r.Pc(1,V,2,0,"div",37),r.ac()),2&e){const e=r.pc();r.Hb(1),r.wc("ngIf",e.f.cat_formation.errors.required)}}function I(e,s){if(1&e&&r.Wb(0,"nz-option",35),2&e){const e=s.$implicit;r.xc("nzLabel",e.ref_form),r.wc("nzValue",e.ref_form)}}function L(e,s){1&e&&(r.bc(0,"div"),r.Rc(1,"R\xe9f\xe9rence est obligatoire"),r.ac())}function M(e,s){if(1&e&&(r.bc(0,"div",36),r.Pc(1,L,2,0,"div",37),r.ac()),2&e){const e=r.pc(2);r.Hb(1),r.wc("ngIf",e.f.ref_formation.errors.required)}}const B=function(e){return{"is-invalid":e}};function Y(e,s){if(1&e){const e=r.cc();r.bc(0,"div",11),r.bc(1,"nz-select",38),r.mc("ngModelChange",(function(s){return r.Gc(e),r.pc().changeRef(s)})),r.Pc(2,I,1,2,"nz-option",13),r.ac(),r.Pc(3,M,2,1,"div",14),r.ac()}if(2&e){const e=r.pc();r.Hb(1),r.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",r.Bc(4,B,e.submitted&&e.f.ref_formation.errors)),r.Hb(1),r.wc("ngForOf",e.cours),r.Hb(1),r.wc("ngIf",e.submitted&&e.f.ref_formation.errors)}}function N(e,s){if(1&e&&r.Wb(0,"nz-option",35),2&e){const e=s.$implicit;r.xc("nzLabel",e.version),r.wc("nzValue",e.version)}}function x(e,s){1&e&&(r.bc(0,"div"),r.Rc(1,"version est obligatoire"),r.ac())}function q(e,s){if(1&e&&(r.bc(0,"div",36),r.Pc(1,x,2,0,"div",37),r.ac()),2&e){const e=r.pc(2);r.Hb(1),r.wc("ngIf",e.f.version_session.errors.required)}}function W(e,s){if(1&e&&(r.bc(0,"div",11),r.bc(1,"nz-select",39),r.Pc(2,N,1,2,"nz-option",13),r.ac(),r.Pc(3,q,2,1,"div",14),r.ac()),2&e){const e=r.pc();r.Hb(1),r.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",r.Bc(4,B,e.submitted&&e.f.version_session.errors)),r.Hb(1),r.wc("ngForOf",e.versions),r.Hb(1),r.wc("ngIf",e.submitted&&e.f.version_session.errors)}}function A(e,s){1&e&&(r.bc(0,"div"),r.Rc(1,"Date de d\xe9but est obligatoire"),r.ac())}function E(e,s){if(1&e&&(r.bc(0,"div",36),r.Pc(1,A,2,0,"div",37),r.ac()),2&e){const e=r.pc();r.Hb(1),r.wc("ngIf",e.f.date_debut.errors.required)}}function k(e,s){1&e&&(r.bc(0,"div"),r.Rc(1,"type est obligatoire"),r.ac())}function O(e,s){if(1&e&&(r.bc(0,"div",36),r.Pc(1,k,2,0,"div",37),r.ac()),2&e){const e=r.pc();r.Hb(1),r.wc("ngIf",e.f.type.errors.required)}}function T(e,s){1&e&&(r.bc(0,"div"),r.Rc(1,"langue est obligatoire"),r.ac())}function G(e,s){if(1&e&&(r.bc(0,"div",36),r.Pc(1,T,2,0,"div",37),r.ac()),2&e){const e=r.pc();r.Hb(1),r.wc("ngIf",e.f.langue.errors.required)}}function $(e,s){if(1&e&&(r.Wb(0,"nz-option",35),r.qc(1,"titlecase")),2&e){const e=s.$implicit;r.xc("nzLabel",r.rc(1,2,e.name)),r.wc("nzValue",e.name)}}function j(e,s){1&e&&(r.bc(0,"div"),r.Rc(1,"Pays est obligatoire"),r.ac())}function X(e,s){if(1&e&&(r.bc(0,"div",36),r.Pc(1,j,2,0,"div",37),r.ac()),2&e){const e=r.pc(2);r.Hb(1),r.wc("ngIf",e.f.lieu.errors.required)}}function Z(e,s){if(1&e&&(r.bc(0,"div",11),r.bc(1,"nz-select",40),r.Pc(2,$,2,4,"nz-option",13),r.ac(),r.Pc(3,X,2,1,"div",14),r.ac()),2&e){const e=r.pc();r.Hb(1),r.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",r.Bc(4,B,e.submitted&&e.f.lieu.errors)),r.Hb(1),r.wc("ngForOf",e.countryList),r.Hb(1),r.wc("ngIf",e.submitted&&e.f.lieu.errors)}}function K(e,s){1&e&&(r.bc(0,"div"),r.Rc(1,"statut de session est obligatoire"),r.ac())}function J(e,s){if(1&e&&(r.bc(0,"div",36),r.Pc(1,K,2,0,"div",37),r.ac()),2&e){const e=r.pc();r.Hb(1),r.wc("ngIf",e.f.etat_session.errors.required)}}let U=(()=>{class e{constructor(e,s,t,i,n,o){this.formBuilder=e,this.router=s,this.toastr=t,this.coursService=i,this.sessionService=n,this.categorieService=o,this.submitted=!1,this.displayRef=!1,this.displayVersion=!1,this.displayCountry=!1,this.cours=[],this.testcours=[],this.filtercours=[],this.categories=[],this.versions=[],this.allCours=[],this.verif=!1,this.title="json-file-read-angular",this.isLoading=!1,this.countryList=z}ngOnInit(){const e=new Date;this.todayDate={year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()},this.fetchCategorie(),this.fetchCours(),this.fetchAllCours(),this.SessionForm=this.formBuilder.group({ref_formation:["",[v.u.required]],version_session:[""],cat_formation:[""],date_debut:["",[v.u.required]],type:["",[v.u.required]],langue:["",[v.u.required]],lieu:[""],etat_session:["en attente de confirmation",[v.u.required]]})}get f(){return this.SessionForm.controls}onSubmit(){if(this.submitted=!0,this.SessionForm.invalid)return;this.isLoading=!0;const e=this.SessionForm.value.date_debut,s=new Date(e.year,e.month-1,e.day),t=o(s).format("YYYY-MM-DD");if(this.submitted=!0,this.SessionForm.invalid)return;let i=[];i=this.allCours.filter(null!==this.versions[0].version&&""!==this.versions[0].version?e=>e.ref_form===this.SessionForm.value.ref_formation&&e.version===this.SessionForm.value.version_session:e=>e.ref_form===this.SessionForm.value.ref_formation),this.sessionService.saveSession({id_cour:i[0].id,date_debut:t,type:this.SessionForm.value.type,langue:this.SessionForm.value.langue,lieu:this.SessionForm.value.lieu||null,etat_session:this.SessionForm.value.etat_session}).subscribe(e=>{e.success?(this.toastr.success("Succ\xe8s"),this.router.navigate(["/admin/list-session-cours-examen/session-cours/list-cours"])):(this.toastr.error("Erreur",e.error),this.isLoading=!1)})}onchange(e){e&&(this.displayRef=!0,this.displayVersion=!1,this.SessionForm.patchValue({ref_formation:"",version_session:""}),this.submitted=!1,this.filtercours=this.testcours.filter(e=>e.categorie===this.SessionForm.value.cat_formation),this.cours=this.filtercours.map(e=>e))}changeRef(e){e&&(this.versions=[],this.SessionForm.patchValue({version_session:""}),this.submitted=!1,this.coursService.getAllVersionByRef(this.SessionForm.value.ref_formation).subscribe(e=>{this.versions=e.result,null!==this.versions[0].version&&""!==this.versions[0].version?(this.displayVersion=!0,this.SessionForm.get("version_session").setValidators(v.u.required)):(this.SessionForm.get("version_session").clearValidators(),this.displayVersion=!1,this.SessionForm.patchValue({version_session:""}))}))}fetchCours(){this.coursService.getAllDistinctCours().subscribe(e=>{this.testcours=e.result,this.cours=e.result})}fetchAllCours(){this.coursService.getAllCours().subscribe(e=>{this.allCours=e.results})}fetchCategorie(){this.categorieService.getAllCategories().subscribe(e=>{this.categories=e.results})}changeType(e){e&&("pr\xe9sentielle"===this.SessionForm.value.type?(this.displayCountry=!0,this.SessionForm.get("lieu").setValidators(v.u.required)):(this.SessionForm.get("lieu").clearValidators(),this.displayCountry=!1,this.SessionForm.patchValue({lieu:""})))}}return e.\u0275fac=function(s){return new(s||e)(r.Vb(v.e),r.Vb(a.c),r.Vb(C.b),r.Vb(y.a),r.Vb(c.a),r.Vb(_.a))},e.\u0275cmp=r.Pb({type:e,selectors:[["app-add-session"]],decls:48,vars:31,consts:[[1,"content-wrapper"],[1,"content"],[1,"container-fluid"],[1,"text-right","mt-5",2,"padding-top","50px !important"],["routerLink","/admin/list-session-cours-examen/session-cours/list-cours",1,"btn","btn-success","mr-2"],[1,"fas","fa-arrow-alt-circle-left"],[1,"row","mb-2"],[1,"col-sm-12","text-center","mb-4"],[1,"add-title"],[1,"col-12","col-md-6","mx-auto"],[3,"formGroup","ngSubmit"],[1,"input-group","mb-3"],["nzPlaceHolder","Choisir une cat\xe9gorie","formControlName","cat_formation",3,"nzNotFoundContent","ngClass","ngModelChange"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["class","invalid-feedback",4,"ngIf"],["class","input-group mb-3",4,"ngIf"],["autocomplete","off","formControlName","date_debut","placeholder","Date de d\xe9but","name","d","ngbDatepicker","",1,"form-control","form-control-sm",3,"ngClass","minDate","click"],["d","ngbDatepicker"],[1,"input-group-append"],["type","button",1,"btn","btn-outline-secondary","calendar","btn-sm",3,"click"],[1,"far","fa-calendar-alt"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Choisir un type","formControlName","type",3,"nzNotFoundContent","ngClass","ngModelChange"],["nzLabel","Pr\xe9sentielle","nzValue","pr\xe9sentielle"],["nzLabel","Distancielle","nzValue","distancielle"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Choisir une langue","formControlName","langue",3,"nzNotFoundContent","ngClass"],["nzLabel","Fran\xe7ais","nzValue","fran\xe7ais"],["nzLabel","Anglais","nzValue","anglais"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Choisir une statut de session","formControlName","etat_session",3,"nzNotFoundContent","ngClass"],["nzLabel","En attente de confirmation","nzValue","en attente de confirmation"],["nzLabel","Confirm\xe9e","nzValue","confirm\xe9e"],["nzLabel","Report\xe9e","nzValue","report\xe9e"],["nzLabel","Annul\xe9e","nzValue","annul\xe9e"],[1,"row"],[1,"col-12","mb-4","text-center"],["type","submit","nz-button","","nzType","primary","nzBlock","",3,"nzLoading"],[3,"nzLabel","nzValue"],[1,"invalid-feedback"],[4,"ngIf"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Choisir une r\xe9f\xe9rence","formControlName","ref_formation",3,"nzNotFoundContent","ngClass","ngModelChange"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Choisir une version","formControlName","version_session",3,"nzNotFoundContent","ngClass"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Choisir un pays","formControlName","lieu",3,"nzNotFoundContent","ngClass"]],template:function(e,s){if(1&e){const e=r.cc();r.bc(0,"div",0),r.bc(1,"section",1),r.bc(2,"div",2),r.bc(3,"div",3),r.bc(4,"button",4),r.Wb(5,"i",5),r.Rc(6," Retour "),r.ac(),r.ac(),r.bc(7,"div",6),r.bc(8,"div",7),r.bc(9,"h1",8),r.Rc(10,"Ajouter une session"),r.ac(),r.ac(),r.bc(11,"div",9),r.bc(12,"form",10),r.mc("ngSubmit",(function(){return s.onSubmit()})),r.bc(13,"div",11),r.bc(14,"nz-select",12),r.mc("ngModelChange",(function(e){return s.onchange(e)})),r.Pc(15,H,1,2,"nz-option",13),r.ac(),r.Pc(16,D,2,1,"div",14),r.ac(),r.Pc(17,Y,4,6,"div",15),r.Pc(18,W,4,6,"div",15),r.bc(19,"div",11),r.bc(20,"input",16,17),r.mc("click",(function(){return r.Gc(e),r.Fc(21).toggle()})),r.ac(),r.bc(22,"div",18),r.bc(23,"button",19),r.mc("click",(function(){return r.Gc(e),r.Fc(21).toggle()})),r.Wb(24,"i",20),r.ac(),r.ac(),r.Pc(25,E,2,1,"div",14),r.ac(),r.bc(26,"div",11),r.bc(27,"nz-select",21),r.mc("ngModelChange",(function(e){return s.changeType(e)})),r.Wb(28,"nz-option",22),r.Wb(29,"nz-option",23),r.ac(),r.Pc(30,O,2,1,"div",14),r.ac(),r.bc(31,"div",11),r.bc(32,"nz-select",24),r.Wb(33,"nz-option",25),r.Wb(34,"nz-option",26),r.ac(),r.Pc(35,G,2,1,"div",14),r.ac(),r.Pc(36,Z,4,6,"div",15),r.bc(37,"div",11),r.bc(38,"nz-select",27),r.Wb(39,"nz-option",28),r.Wb(40,"nz-option",29),r.Wb(41,"nz-option",30),r.Wb(42,"nz-option",31),r.ac(),r.Pc(43,J,2,1,"div",14),r.ac(),r.bc(44,"div",32),r.bc(45,"div",33),r.bc(46,"button",34),r.Rc(47,"Enregistrer"),r.ac(),r.ac(),r.ac(),r.ac(),r.ac(),r.ac(),r.ac(),r.ac(),r.ac()}2&e&&(r.Hb(12),r.wc("formGroup",s.SessionForm),r.Hb(2),r.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",r.Bc(21,B,s.submitted&&s.f.cat_formation.errors)),r.Hb(1),r.wc("ngForOf",s.categories),r.Hb(1),r.wc("ngIf",s.submitted&&s.f.cat_formation.errors),r.Hb(1),r.wc("ngIf",s.displayRef),r.Hb(1),r.wc("ngIf",s.displayVersion),r.Hb(2),r.wc("ngClass",r.Bc(23,B,s.submitted&&s.f.date_debut.errors))("minDate",s.todayDate),r.Hb(5),r.wc("ngIf",s.submitted&&s.f.date_debut.errors),r.Hb(2),r.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",r.Bc(25,B,s.submitted&&s.f.type.errors)),r.Hb(3),r.wc("ngIf",s.submitted&&s.f.type.errors),r.Hb(2),r.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",r.Bc(27,B,s.submitted&&s.f.langue.errors)),r.Hb(3),r.wc("ngIf",s.submitted&&s.f.langue.errors),r.Hb(1),r.wc("ngIf",s.displayCountry),r.Hb(2),r.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",r.Bc(29,B,s.submitted&&s.f.etat_session.errors)),r.Hb(5),r.wc("ngIf",s.submitted&&s.f.etat_session.errors),r.Hb(3),r.wc("nzLoading",s.isLoading))},directives:[a.d,v.w,v.n,v.h,S.b,v.m,v.g,i.l,i.m,i.n,v.d,w.a,S.a,F.a,R.a,P.a],pipes:[i.x],styles:["@media(max-width:768px){.add-title[_ngcontent-%COMP%]{font-size:2rem!important;margin-top:50px}.form-control[_ngcontent-%COMP%]{font-size:.8rem!important}}nz-select[_ngcontent-%COMP%]{width:100%}"]}),e})();var Q=t("mrSG"),ee=t("VvmD");function se(e,s){if(1&e&&r.Wb(0,"nz-option",38),2&e){const e=s.$implicit;r.xc("nzLabel",e.nom_categorie),r.wc("nzValue",e.nom_categorie)}}function te(e,s){1&e&&(r.bc(0,"div"),r.Rc(1,"cat\xe9gorie est obligatoire"),r.ac())}function ie(e,s){if(1&e&&(r.bc(0,"div",39),r.Pc(1,te,2,0,"div",40),r.ac()),2&e){const e=r.pc();r.Hb(1),r.wc("ngIf",e.f.cat_formation.errors.required)}}function ne(e,s){if(1&e&&r.Wb(0,"nz-option",38),2&e){const e=s.$implicit;r.xc("nzLabel",e.ref_form),r.wc("nzValue",e.ref_form)}}function oe(e,s){1&e&&(r.bc(0,"div"),r.Rc(1,"R\xe9f\xe9rence est obligatoire"),r.ac())}function re(e,s){if(1&e&&(r.bc(0,"div",39),r.Pc(1,oe,2,0,"div",40),r.ac()),2&e){const e=r.pc();r.Hb(1),r.wc("ngIf",e.f.ref_formation.errors.required)}}function ce(e,s){if(1&e&&r.Wb(0,"nz-option",38),2&e){const e=s.$implicit;r.xc("nzLabel",e.version),r.wc("nzValue",e.version)}}function ae(e,s){1&e&&(r.bc(0,"div"),r.Rc(1,"version est obligatoire"),r.ac())}function le(e,s){if(1&e&&(r.bc(0,"div",39),r.Pc(1,ae,2,0,"div",40),r.ac()),2&e){const e=r.pc(2);r.Hb(1),r.wc("ngIf",e.f.version_session.errors.required)}}const ue=function(e){return{"is-invalid":e}};function de(e,s){if(1&e&&(r.bc(0,"div",11),r.bc(1,"nz-select",41),r.Pc(2,ce,1,2,"nz-option",13),r.ac(),r.Pc(3,le,2,1,"div",14),r.ac()),2&e){const e=r.pc();r.Hb(1),r.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",r.Bc(4,ue,e.submitted&&e.f.version_session.errors)),r.Hb(1),r.wc("ngForOf",e.versions),r.Hb(1),r.wc("ngIf",e.submitted&&e.f.version_session.errors)}}function be(e,s){1&e&&(r.bc(0,"div"),r.Rc(1,"Date de d\xe9but est obligatoire"),r.ac())}function fe(e,s){if(1&e&&(r.bc(0,"div",39),r.Pc(1,be,2,0,"div",40),r.ac()),2&e){const e=r.pc();r.Hb(1),r.wc("ngIf",e.f.date_debut.errors.required)}}function me(e,s){1&e&&(r.bc(0,"div"),r.Rc(1,"type est obligatoire"),r.ac())}function he(e,s){if(1&e&&(r.bc(0,"div",39),r.Pc(1,me,2,0,"div",40),r.ac()),2&e){const e=r.pc();r.Hb(1),r.wc("ngIf",e.f.type.errors.required)}}function ge(e,s){1&e&&(r.bc(0,"div"),r.Rc(1,"langue est obligatoire"),r.ac())}function pe(e,s){if(1&e&&(r.bc(0,"div",39),r.Pc(1,ge,2,0,"div",40),r.ac()),2&e){const e=r.pc();r.Hb(1),r.wc("ngIf",e.f.langue.errors.required)}}function ve(e,s){if(1&e&&(r.Wb(0,"nz-option",38),r.qc(1,"titlecase")),2&e){const e=s.$implicit;r.xc("nzLabel",r.rc(1,2,e.name)),r.wc("nzValue",e.name)}}function ze(e,s){1&e&&(r.bc(0,"div"),r.Rc(1,"Pays est obligatoire"),r.ac())}function Ce(e,s){if(1&e&&(r.bc(0,"div",39),r.Pc(1,ze,2,0,"div",40),r.ac()),2&e){const e=r.pc(2);r.Hb(1),r.wc("ngIf",e.f.lieu.errors.required)}}function ye(e,s){if(1&e&&(r.bc(0,"div",11),r.bc(1,"nz-select",42),r.Pc(2,ve,2,4,"nz-option",13),r.ac(),r.Pc(3,Ce,2,1,"div",14),r.ac()),2&e){const e=r.pc();r.Hb(1),r.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",r.Bc(4,ue,e.submitted&&e.f.lieu.errors)),r.Hb(1),r.wc("ngForOf",e.countryList),r.Hb(1),r.wc("ngIf",e.submitted&&e.f.lieu.errors)}}function _e(e,s){1&e&&(r.bc(0,"div"),r.Rc(1,"statut de session est obligatoire"),r.ac())}function Se(e,s){if(1&e&&(r.bc(0,"div",39),r.Pc(1,_e,2,0,"div",40),r.ac()),2&e){const e=r.pc();r.Hb(1),r.wc("ngIf",e.f.etat_session.errors.required)}}const we=[{path:"",component:p,children:[{path:"list-session",component:g.a},{path:"list-session-inactive",component:h.a},{path:"add-session",component:U,canActivate:[n.a]},{path:"edit-session/:id",component:(()=>{class e{constructor(e,s,t,i,n,o,r,c){this.formBuilder=e,this.router=s,this.toastr=t,this.coursService=i,this.sessionService=n,this.route=o,this.categorieService=r,this.planningService=c,this.submitted=!1,this.cours=[],this.sessionEmail=[],this.displayRef=!1,this.displayVersion=!1,this.displayCountry=!1,this.allCours=[],this.filtercours=[],this.categories=[],this.versions=[],this.filtcategorie=[],this.plannigBySession=[],this.title="json-file-read-angular",this.isLoading=!1,this.countryList=z}ngOnInit(){const e=new Date;this.todayDate={year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()},this.dateTodayVerif=o(new Date).add(-1,"days").format("YYYY-MM-DD"),this.fetchCategorie(),this.fetchAllCours(),this.id=this.route.snapshot.paramMap.get("id"),this.fetchSessionWithEmail(this.id),this.sessionService.getSessionById(this.id).subscribe(e=>Object(Q.b)(this,void 0,void 0,(function*(){this.Result=e.result[0],this.newDateDebut=o(this.Result.date_debut).format("YYYY-MM-DD"),this.a=new Date(this.Result.date_debut),this.year=this.a.getFullYear(),this.month=this.a.getMonth()+1,this.day=this.a.getDate(),this.debut={year:this.year,month:this.month,day:this.day},this.defautfetchCours(),this.defautversion(),this.defaultDisplayCountry(),this.SessionForm.patchValue({cat_formation:this.Result.categorie,ref_formation:this.Result.ref_formation,version_session:this.Result.version_session,type:this.Result.type,date_debut:this.debut,langue:this.Result.langue,lieu:this.Result.lieu,etat_session:this.Result.etat_session})}))),this.SessionForm=this.formBuilder.group({cat_formation:[""],ref_formation:["",[v.u.required]],date_debut:["",[v.u.required]],type:["",[v.u.required]],version_session:[""],langue:["",[v.u.required]],lieu:[""],etat_session:["en attente de confirmation",[v.u.required]]})}get f(){return this.SessionForm.controls}onSubmit(){if(this.submitted=!0,this.SessionForm.invalid)return;this.isLoading=!0;const e=this.SessionForm.value.date_debut,s=new Date(e.year,e.month-1,e.day),t=o(s).format("YYYY-MM-DD");let i=[];i=this.allCours.filter(null!==this.versions[0].version&&""!==this.versions[0].version?e=>e.ref_form===this.SessionForm.value.ref_formation&&e.version===this.SessionForm.value.version_session:e=>e.ref_form===this.SessionForm.value.ref_formation);const n={id_cour:i[0].id,date_debut:t,type:this.SessionForm.value.type,langue:this.SessionForm.value.langue,lieu:this.SessionForm.value.lieu||null,etat_session:this.SessionForm.value.etat_session};this.dateTodayVerif<o(this.Result.date_fin).format("YYYY-MM-DD")&&this.sessionService.updateSession(this.id,n).subscribe(e=>Object(Q.b)(this,void 0,void 0,(function*(){if(e.success){if(this.sessionEmail[0].email&&"en cours"!==n.etat_session&&"cl\xf4tur\xe9e"!==n.etat_session){const e=new Date(n.date_debut),s=this.sessionEmail[0].duree-1;e.setDate(e.getDate()+s),null!==this.versions[0].version&&""!==this.versions[0].version||(this.SessionForm.value.version_session=null),"annul\xe9e"!==n.etat_session&&"report\xe9e"!==n.etat_session||(this.plannigBySession[0].statut_f="Annul\xe9e"),"confirm\xe9e"===n.etat_session&&(this.plannigBySession[0].statut_f="Confirm\xe9e"),"pr\xe9sentielle"===this.SessionForm.value.type?yield this.envoyerEmail(this.sessionEmail[0].email,this.SessionForm.value.ref_formation,o(n.date_debut).format("DD-MM-YYYY"),o(e).format("DD-MM-YYYY"),n.type,n.langue,this.plannigBySession[0].address,this.SessionForm.value.version_session,this.plannigBySession[0].statut_f,n.etat_session,this.sessionEmail[0].name,i[0].designation,n.lieu,this.plannigBySession[0].contact_for,this.plannigBySession[0].numero_for,this.plannigBySession[0].mail_contact,this.plannigBySession[0].nbr_participant):yield this.envoyerEmailDistancielle(this.sessionEmail[0].email,this.SessionForm.value.ref_formation,o(n.date_debut).format("DD-MM-YYYY"),o(e).format("DD-MM-YYYY"),n.type,n.langue,this.SessionForm.value.version_session,this.plannigBySession[0].statut_f,n.etat_session,this.sessionEmail[0].name,i[0].designation,this.plannigBySession[0].contact_for,this.plannigBySession[0].numero_for,this.plannigBySession[0].mail_contact,this.plannigBySession[0].nbr_participant)}this.sessionEmail[0].email&&"en cours"!==n.etat_session&&"cl\xf4tur\xe9e"!==n.etat_session&&"confirm\xe9e"!==n.etat_session&&"en attente de confirmation"!==n.etat_session&&this.planningService.editPlanningForSession({id:this.plannigBySession[0].id,statut_f:"annul\xe9e"}).subscribe(e=>{e.success||this.toastr.error("Erreur",e.error)}),this.sessionEmail[0].email&&"confirm\xe9e"===n.etat_session&&this.planningService.editPlanningForSession({id:this.plannigBySession[0].id,statut_f:"Confirm\xe9e"}).subscribe(e=>{e.success||this.toastr.error("Erreur",e.error)}),this.toastr.success("Succ\xe8s"),this.router.navigate(["/admin/list-session-cours-examen/session-cours/list-cours"])}else this.toastr.error("Erreur",e.error),this.isLoading=!1})))}fetchAllCours(){this.coursService.getAllCours().subscribe(e=>{this.allCours=e.results})}defautfetchCours(){this.coursService.getAllDistinctCours().subscribe(e=>{this.cours=e.result,this.filtercours=this.cours.filter(e=>e.categorie===this.Result.categorie)})}fetchSessionWithEmail(e){this.sessionService.getSessionWithEmailById(e).subscribe(e=>{this.sessionEmail=e.result}),this.planningService.getPlanningUpdatedByIdSession(this.id).subscribe(e=>{this.plannigBySession=e.result})}fetchCategorie(){this.categorieService.getAllCategories().subscribe(e=>{this.categories=e.results})}onchange(e){e&&(this.submitted=!1,this.displayVersion=!1,this.SessionForm.patchValue({ref_formation:"",version_session:""}),this.filtercours=[],this.filtercours=this.cours.filter(e=>e.categorie===this.SessionForm.value.cat_formation))}changeRef(e){e&&this.SessionForm.value.ref_formation&&(this.submitted=!1,this.versions=[],this.SessionForm.patchValue({version_session:""}),this.coursService.getAllVersionByRef(this.SessionForm.value.ref_formation).subscribe(e=>{this.versions=e.result,null!==this.versions[0].version&&""!==this.versions[0].version?(this.displayVersion=!0,this.SessionForm.get("version_session").setValidators(v.u.required)):(this.SessionForm.get("version_session").clearValidators(),this.displayVersion=!1)}))}defautversion(){this.versions=[],this.coursService.getAllVersionByRef(this.Result.ref_formation).subscribe(e=>{this.versions=e.result,null!==this.versions[0].version&&""!==this.versions[0].version?(this.displayVersion=!0,this.SessionForm.get("version_session").setValidators(v.u.required)):(this.SessionForm.get("version_session").clearValidators(),this.displayVersion=!1)})}changeType(e){e&&("pr\xe9sentielle"===this.SessionForm.value.type?(this.displayCountry=!0,this.SessionForm.get("lieu").setValidators(v.u.required)):(this.displayCountry=!1,this.SessionForm.get("lieu").clearValidators(),this.SessionForm.patchValue({lieu:""})))}defaultDisplayCountry(){"pr\xe9sentielle"===this.Result.type?(this.displayCountry=!0,this.SessionForm.get("lieu").setValidators(v.u.required)):(this.displayCountry=!1,this.SessionForm.get("lieu").clearValidators(),this.SessionForm.patchValue({lieu:""}))}envoyerEmail(e,s,t,i,n,o,r,c,a,l,u,d,b,f,m,h,g){this.sessionService.envoyerEmailFormateur(e,s,t,i,n,o,r,c,a,l,u,d,b,f,m,h,g).subscribe(e=>{e.success||this.toastr.error("Error",e.error)})}envoyerEmailDistancielle(e,s,t,i,n,o,r,c,a,l,u,d,b,f,m){this.sessionService.envoyerEmailFormateurTypeDistancielle(e,s,t,i,n,o,r,c,a,l,u,d,b,f,m).subscribe(e=>{e.success||this.toastr.error("Error",e.error)})}}return e.\u0275fac=function(s){return new(s||e)(r.Vb(v.e),r.Vb(a.c),r.Vb(C.b),r.Vb(y.a),r.Vb(c.a),r.Vb(a.a),r.Vb(_.a),r.Vb(ee.a))},e.\u0275cmp=r.Pb({type:e,selectors:[["app-edit-session"]],decls:53,vars:36,consts:[[1,"content-wrapper"],[1,"content"],[1,"container-fluid"],[1,"text-right","mt-5",2,"padding-top","50px !important"],["routerLink","/admin/list-session-cours-examen/session-cours/list-cours",1,"btn","btn-success","mr-2"],[1,"fas","fa-arrow-alt-circle-left"],[1,"row","mb-2"],[1,"col-sm-12","text-center","mb-4"],[1,"edit-title"],[1,"col-12","col-md-6","mx-auto"],[3,"formGroup","ngSubmit"],[1,"input-group","mb-3"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Choisir une cat\xe9gorie","formControlName","cat_formation",3,"nzNotFoundContent","ngClass","ngModelChange"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["class","invalid-feedback",4,"ngIf"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Choisir une r\xe9f\xe9rence","formControlName","ref_formation",3,"nzNotFoundContent","ngClass","ngModelChange"],["class","input-group mb-3",4,"ngIf"],["formControlName","date_debut","name","dp","ngbDatepicker","",1,"form-control","form-control-sm",3,"ngClass","minDate","click"],["d","ngbDatepicker"],[1,"input-group-append"],["type","button",1,"btn","btn-outline-secondary","calendar","btn-sm",3,"click"],[1,"far","fa-calendar-alt"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Choisir un type","formControlName","type",3,"nzNotFoundContent","ngClass","ngModelChange"],["nzLabel","Pr\xe9sentielle","nzValue","pr\xe9sentielle"],["nzLabel","Distancielle","nzValue","distancielle"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Choisir une langue","formControlName","langue",3,"nzNotFoundContent","ngClass"],["nzLabel","Fran\xe7ais","nzValue","fran\xe7ais"],["nzLabel","Anglais","nzValue","anglais"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Choisir une statut de session","formControlName","etat_session",3,"nzNotFoundContent","ngClass"],["nzLabel","En attente de confirmation","nzValue","en attente de confirmation"],["nzLabel","Confirm\xe9e","nzValue","confirm\xe9e"],["nzLabel","En cours","nzValue","en cours"],["nzLabel","Cl\xf4tur\xe9e","nzValue","cl\xf4tur\xe9e"],["nzLabel","Report\xe9e","nzValue","report\xe9e"],["nzLabel","Annul\xe9e","nzValue","annul\xe9e"],[1,"row"],[1,"col-12","mb-4","text-center"],["type","submit","nz-button","","nzType","primary","nzBlock","",3,"nzLoading"],[3,"nzLabel","nzValue"],[1,"invalid-feedback"],[4,"ngIf"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Choisir une version","formControlName","version_session",3,"nzNotFoundContent","ngClass"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Choisir un pays","formControlName","lieu",3,"nzNotFoundContent","ngClass"]],template:function(e,s){if(1&e){const e=r.cc();r.bc(0,"div",0),r.bc(1,"section",1),r.bc(2,"div",2),r.bc(3,"div",3),r.bc(4,"button",4),r.Wb(5,"i",5),r.Rc(6," Retour "),r.ac(),r.ac(),r.bc(7,"div",6),r.bc(8,"div",7),r.bc(9,"h1",8),r.Rc(10," Modifier une session"),r.ac(),r.ac(),r.bc(11,"div",9),r.bc(12,"form",10),r.mc("ngSubmit",(function(){return s.onSubmit()})),r.bc(13,"div",11),r.bc(14,"nz-select",12),r.mc("ngModelChange",(function(e){return s.onchange(e)})),r.Pc(15,se,1,2,"nz-option",13),r.ac(),r.Pc(16,ie,2,1,"div",14),r.ac(),r.bc(17,"div",11),r.bc(18,"nz-select",15),r.mc("ngModelChange",(function(e){return s.changeRef(e)})),r.Pc(19,ne,1,2,"nz-option",13),r.ac(),r.Pc(20,re,2,1,"div",14),r.ac(),r.Pc(21,de,4,6,"div",16),r.bc(22,"div",11),r.bc(23,"input",17,18),r.mc("click",(function(){return r.Gc(e),r.Fc(24).toggle()})),r.ac(),r.bc(25,"div",19),r.bc(26,"button",20),r.mc("click",(function(){return r.Gc(e),r.Fc(24).toggle()})),r.Wb(27,"i",21),r.ac(),r.ac(),r.Pc(28,fe,2,1,"div",14),r.ac(),r.bc(29,"div",11),r.bc(30,"nz-select",22),r.mc("ngModelChange",(function(e){return s.changeType(e)})),r.Wb(31,"nz-option",23),r.Wb(32,"nz-option",24),r.ac(),r.Pc(33,he,2,1,"div",14),r.ac(),r.bc(34,"div",11),r.bc(35,"nz-select",25),r.Wb(36,"nz-option",26),r.Wb(37,"nz-option",27),r.ac(),r.Pc(38,pe,2,1,"div",14),r.ac(),r.Pc(39,ye,4,6,"div",16),r.bc(40,"div",11),r.bc(41,"nz-select",28),r.Wb(42,"nz-option",29),r.Wb(43,"nz-option",30),r.Wb(44,"nz-option",31),r.Wb(45,"nz-option",32),r.Wb(46,"nz-option",33),r.Wb(47,"nz-option",34),r.ac(),r.Pc(48,Se,2,1,"div",14),r.ac(),r.bc(49,"div",35),r.bc(50,"div",36),r.bc(51,"button",37),r.Rc(52,"Enregistrer"),r.ac(),r.ac(),r.ac(),r.ac(),r.ac(),r.ac(),r.ac(),r.ac(),r.ac()}2&e&&(r.Hb(12),r.wc("formGroup",s.SessionForm),r.Hb(2),r.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",r.Bc(24,ue,s.submitted&&s.f.cat_formation.errors)),r.Hb(1),r.wc("ngForOf",s.categories),r.Hb(1),r.wc("ngIf",s.submitted&&s.f.cat_formation.errors),r.Hb(2),r.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",r.Bc(26,ue,s.submitted&&s.f.ref_formation.errors)),r.Hb(1),r.wc("ngForOf",s.filtercours),r.Hb(1),r.wc("ngIf",s.submitted&&s.f.ref_formation.errors),r.Hb(1),r.wc("ngIf",s.displayVersion),r.Hb(2),r.wc("ngClass",r.Bc(28,ue,s.submitted&&s.f.date_debut.errors))("minDate",s.todayDate),r.Hb(5),r.wc("ngIf",s.submitted&&s.f.date_debut.errors),r.Hb(2),r.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",r.Bc(30,ue,s.submitted&&s.f.type.errors)),r.Hb(3),r.wc("ngIf",s.submitted&&s.f.type.errors),r.Hb(2),r.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",r.Bc(32,ue,s.submitted&&s.f.langue.errors)),r.Hb(3),r.wc("ngIf",s.submitted&&s.f.langue.errors),r.Hb(1),r.wc("ngIf",s.displayCountry),r.Hb(2),r.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",r.Bc(34,ue,s.submitted&&s.f.etat_session.errors)),r.Hb(7),r.wc("ngIf",s.submitted&&s.f.etat_session.errors),r.Hb(3),r.wc("nzLoading",s.isLoading))},directives:[a.d,v.w,v.n,v.h,S.b,v.m,v.g,i.l,i.m,i.n,v.d,w.a,S.a,F.a,R.a,P.a],pipes:[i.x],styles:["@media(max-width:768px){.edit-title[_ngcontent-%COMP%]{font-size:2rem!important;margin-top:50px}.form-control[_ngcontent-%COMP%]{font-size:.8rem!important}}nz-select[_ngcontent-%COMP%]{width:100%}"]}),e})(),canActivate:[n.a]},{path:"show-session/:id",component:m}]}];let Fe=(()=>{class e{}return e.\u0275mod=r.Tb({type:e}),e.\u0275inj=r.Sb({factory:function(s){return new(s||e)},imports:[[a.g.forChild(we)],a.g]}),e})();var Re=t("oOf3"),Pe=t("cZdB"),He=t("rMZv"),Ve=t("PTRe"),De=t("OtHt");let Ie=(()=>{class e{}return e.\u0275mod=r.Tb({type:e}),e.\u0275inj=r.Sb({factory:function(s){return new(s||e)},imports:[[i.c,Fe,Re.a,Pe.b,v.i,v.s,w.d,S.c,He.d,Ve.c,De.b,F.c]]}),e})()}}]);