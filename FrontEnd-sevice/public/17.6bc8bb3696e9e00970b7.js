(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{wU0g:function(e,s,t){"use strict";t.r(s),t.d(s,"SessionsExamensModule",(function(){return Ve}));var n=t("ofXK"),i=t("DZv2"),o=t("wd/R"),r=t("fXoL"),a=t("bsYF"),c=t("tyNb");function l(e,s){1&e&&(r.bc(0,"button",14),r.Wb(1,"i",15),r.Rc(2," Retour "),r.ac())}function u(e,s){1&e&&(r.bc(0,"button",16),r.Wb(1,"i",15),r.Rc(2," Retour "),r.ac())}function d(e,s){if(1&e&&(r.bc(0,"p",12),r.Rc(1,"Version: "),r.bc(2,"b"),r.Rc(3),r.ac(),r.ac()),2&e){const e=r.pc();r.Hb(3),r.Tc(" ",null==e.Results?null:e.Results.version_session,"")}}function b(e,s){if(1&e&&(r.bc(0,"p",12),r.Rc(1,"Instructeur : "),r.bc(2,"b"),r.Rc(3),r.ac(),r.ac()),2&e){const e=r.pc();r.Hb(3),r.Tc(" ",null==e.Results?null:e.Results.name,"")}}function m(e,s){if(1&e&&(r.bc(0,"p",12),r.Rc(1,"Pays: "),r.bc(2,"b"),r.Rc(3),r.qc(4,"titlecase"),r.ac(),r.ac()),2&e){const e=r.pc();r.Hb(3),r.Tc(" ",r.rc(4,1,null==e.Results?null:e.Results.lieu)," ")}}let f=(()=>{class e{constructor(e,s){this.sessionExamenService=e,this.route=s}ngOnInit(){this.dateYestarday=o(new Date).add(-1,"days").format("YYYY-MM-DD"),this.id=this.route.snapshot.paramMap.get("id"),this.sessionExamenService.getSessionWithEmailById(this.id).subscribe(e=>{this.Results=e.result[0]})}}return e.\u0275fac=function(s){return new(s||e)(r.Vb(a.a),r.Vb(c.a))},e.\u0275cmp=r.Pb({type:e,selectors:[["app-show-session-examen"]],decls:38,vars:16,consts:[[1,"content-wrapper"],[1,"content"],[1,"container-fluid"],[1,"text-right","mt-5",2,"padding-top","50px !important"],["routerLink","/admin/list-session-cours-examen/session-examen/list-examen","class","btn btn-success mr-2",4,"ngIf"],["routerLink","/admin/list-session-cours-examen-inactive/session-examen/list-examen-inactive","class","btn btn-success mr-2",4,"ngIf"],[1,"row","mb-2","mt-4"],[1,"col-12","col-sm-6","col-md-12","col-lg-12"],[1,"card","bg-light"],[1,"card-body","pt-5"],[1,"row"],[1,"col-12"],[1,"lead","text-muted"],["class","lead text-muted",4,"ngIf"],["routerLink","/admin/list-session-cours-examen/session-examen/list-examen",1,"btn","btn-success","mr-2"],[1,"fas","fa-arrow-alt-circle-left"],["routerLink","/admin/list-session-cours-examen-inactive/session-examen/list-examen-inactive",1,"btn","btn-success","mr-2"]],template:function(e,s){1&e&&(r.bc(0,"div",0),r.bc(1,"section",1),r.bc(2,"div",2),r.bc(3,"div",3),r.Pc(4,l,3,0,"button",4),r.Pc(5,u,3,0,"button",5),r.ac(),r.bc(6,"div",6),r.bc(7,"div",7),r.bc(8,"div",8),r.bc(9,"div",9),r.bc(10,"div",10),r.bc(11,"div",11),r.bc(12,"p",12),r.Rc(13," R\xe9f\xe9rence: "),r.bc(14,"b"),r.Rc(15),r.ac(),r.ac(),r.Pc(16,d,4,1,"p",13),r.bc(17,"p",12),r.Rc(18,"Dur\xe9e: "),r.bc(19,"b"),r.Rc(20),r.ac(),r.ac(),r.Pc(21,b,4,1,"p",13),r.bc(22,"p",12),r.Rc(23,"Date: "),r.bc(24,"b"),r.Rc(25),r.qc(26,"date"),r.ac(),r.ac(),r.bc(27,"p",12),r.Rc(28,"Langue: "),r.bc(29,"b"),r.Rc(30),r.qc(31,"titlecase"),r.ac(),r.ac(),r.Pc(32,m,5,3,"p",13),r.bc(33,"p",12),r.Rc(34,"Statut de session: "),r.bc(35,"b"),r.Rc(36),r.qc(37,"titlecase"),r.ac(),r.ac(),r.ac(),r.ac(),r.ac(),r.ac(),r.ac(),r.ac(),r.ac(),r.ac(),r.ac()),2&e&&(r.Hb(4),r.wc("ngIf",(null==s.Results?null:s.Results.date_examen)>s.dateYestarday),r.Hb(1),r.wc("ngIf",(null==s.Results?null:s.Results.date_examen)<s.dateYestarday),r.Hb(10),r.Sc(null==s.Results?null:s.Results.ref_formation),r.Hb(1),r.wc("ngIf",null==s.Results?null:s.Results.version_session),r.Hb(4),r.Tc(" ",null==s.Results?null:s.Results.duree,""),r.Hb(1),r.wc("ngIf",null==s.Results?null:s.Results.affecter),r.Hb(4),r.Tc(" ",r.rc(26,10,null==s.Results?null:s.Results.date_examen),""),r.Hb(5),r.Tc(" ",r.rc(31,12,null==s.Results?null:s.Results.langue)," "),r.Hb(2),r.wc("ngIf",null==s.Results?null:s.Results.lieu),r.Hb(4),r.Tc(" ",r.rc(37,14,null==s.Results?null:s.Results.etat_session)," "))},directives:[n.n,c.d],pipes:[n.e,n.x],styles:[".lead[_ngcontent-%COMP%]{font-size:.9rem;font-weight:300}@media(max-width:768px){.lead[_ngcontent-%COMP%]{font-size:.8rem}}"]}),e})();var h=t("mrSG"),g=t("3WhB"),v=t("3Pt+"),p=t("Rm4T"),z=t("gXqy"),_=t("5eHb"),C=t("/IFS"),w=t("Cxpb"),S=t("XUh5"),H=t("zAKX"),x=t("0lU3"),R=t("OzZK"),P=t("RwU8"),F=t("C2AL");function y(e,s){if(1&e&&r.Wb(0,"nz-option",32),2&e){const e=s.$implicit;r.xc("nzLabel",e.nom_categorie),r.wc("nzValue",e.nom_categorie)}}function V(e,s){1&e&&(r.bc(0,"div"),r.Rc(1,"cat\xe9gorie est obligatoire"),r.ac())}function I(e,s){if(1&e&&(r.bc(0,"div",33),r.Pc(1,V,2,0,"div",34),r.ac()),2&e){const e=r.pc();r.Hb(1),r.wc("ngIf",e.f.cat_formation.errors.required)}}function L(e,s){if(1&e&&r.Wb(0,"nz-option",32),2&e){const e=s.$implicit;r.xc("nzLabel",e.ref_form),r.wc("nzValue",e.ref_form)}}function M(e,s){1&e&&(r.bc(0,"div"),r.Rc(1,"R\xe9f\xe9rence est obligatoire"),r.ac())}function N(e,s){if(1&e&&(r.bc(0,"div",33),r.Pc(1,M,2,0,"div",34),r.ac()),2&e){const e=r.pc();r.Hb(1),r.wc("ngIf",e.f.ref_formation.errors.required)}}function D(e,s){if(1&e&&r.Wb(0,"nz-option",32),2&e){const e=s.$implicit;r.xc("nzLabel",e.version),r.wc("nzValue",e.version)}}function E(e,s){1&e&&(r.bc(0,"div"),r.Rc(1,"version est obligatoire"),r.ac())}function B(e,s){if(1&e&&(r.bc(0,"div",33),r.Pc(1,E,2,0,"div",34),r.ac()),2&e){const e=r.pc(2);r.Hb(1),r.wc("ngIf",e.f.version_session.errors.required)}}const q=function(e){return{"is-invalid":e}};function A(e,s){if(1&e&&(r.bc(0,"div",11),r.bc(1,"nz-select",35),r.Pc(2,D,1,2,"nz-option",13),r.ac(),r.Pc(3,B,2,1,"div",14),r.ac()),2&e){const e=r.pc();r.Hb(1),r.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",r.Bc(4,q,e.submitted&&e.f.version_session.errors)),r.Hb(1),r.wc("ngForOf",e.versions),r.Hb(1),r.wc("ngIf",e.submitted&&e.f.version_session.errors)}}function W(e,s){1&e&&(r.bc(0,"div"),r.Rc(1,"Date est obligatoire"),r.ac())}function O(e,s){if(1&e&&(r.bc(0,"div",33),r.Pc(1,W,2,0,"div",34),r.ac()),2&e){const e=r.pc();r.Hb(1),r.wc("ngIf",e.f.date_debut.errors.required)}}function Y(e,s){1&e&&(r.bc(0,"div"),r.Rc(1,"langue est obligatoire"),r.ac())}function k(e,s){if(1&e&&(r.bc(0,"div",33),r.Pc(1,Y,2,0,"div",34),r.ac()),2&e){const e=r.pc();r.Hb(1),r.wc("ngIf",e.f.langue.errors.required)}}function T(e,s){if(1&e&&(r.Wb(0,"nz-option",32),r.qc(1,"titlecase")),2&e){const e=s.$implicit;r.xc("nzLabel",r.rc(1,2,e.name)),r.wc("nzValue",e.name)}}function j(e,s){1&e&&(r.bc(0,"div"),r.Rc(1,"Pays est obligatoire"),r.ac())}function $(e,s){if(1&e&&(r.bc(0,"div",33),r.Pc(1,j,2,0,"div",34),r.ac()),2&e){const e=r.pc();r.Hb(1),r.wc("ngIf",e.f.lieu.errors.required)}}function G(e,s){1&e&&(r.bc(0,"div"),r.Rc(1,"statut de session est obligatoire"),r.ac())}function U(e,s){if(1&e&&(r.bc(0,"div",33),r.Pc(1,G,2,0,"div",34),r.ac()),2&e){const e=r.pc();r.Hb(1),r.wc("ngIf",e.f.etat_session.errors.required)}}const X=function(){return{nzFormat:"HH:mm"}};let Z=(()=>{class e{constructor(e,s,t,n,i,o,r,a,c){this.formBuilder=e,this.router=s,this.toastr=t,this.examenService=n,this.sessionExamenService=i,this.route=o,this.categorieService=r,this.planningExamenService=a,this.i18n=c,this.submitted=!1,this.cours=[],this.sessionEmail=[],this.displayRef=!1,this.displayVersion=!1,this.displayCountry=!1,this.allCours=[],this.filtercours=[],this.categories=[],this.versions=[],this.filtcategorie=[],this.plannigBySession=[],this.today=new Date,this.title="json-file-read-angular",this.isLoading=!1,this.countryList=g,this.disabledDate=e=>Object(z.a)(e,this.today)<0}ngOnInit(){this.i18n.setLocale(p.e),new Date,this.dateTodayVerif=o(new Date).add(-1,"days").format("YYYY-MM-DD"),this.fetchCategorie(),this.fetchAllCours(),this.id=this.route.snapshot.paramMap.get("id"),this.fetchSessionWithEmail(this.id),this.sessionExamenService.getSessionById(this.id).subscribe(e=>Object(h.b)(this,void 0,void 0,(function*(){this.Result=e.result[0],this.defautfetchCours(),this.defautversion(),this.SessionForm.patchValue({cat_formation:this.Result.categorie,ref_formation:this.Result.ref_formation,version_session:this.Result.version_session,date_debut:this.Result.date_examen,langue:this.Result.langue,lieu:this.Result.lieu,etat_session:this.Result.etat_session})}))),this.SessionForm=this.formBuilder.group({cat_formation:["",[v.u.required]],ref_formation:["",[v.u.required]],date_debut:["",[v.u.required]],version_session:[""],langue:["",[v.u.required]],lieu:["",[v.u.required]],etat_session:["en attente de confirmation",[v.u.required]]})}get f(){return this.SessionForm.controls}onSubmit(){if(this.submitted=!0,this.SessionForm.invalid)return;this.isLoading=!0;const e=o(this.SessionForm.value.date_debut).format("YYYY-MM-DD HH:mm:ss");let s=[];s=this.allCours.filter(null!==this.versions[0].version&&""!==this.versions[0].version?e=>e.ref_form===this.SessionForm.value.ref_formation&&e.version===this.SessionForm.value.version_session:e=>e.ref_form===this.SessionForm.value.ref_formation);const t={id_examen:s[0].id,date_examen:e,langue:this.SessionForm.value.langue,lieu:this.SessionForm.value.lieu||null,etat_session:this.SessionForm.value.etat_session},n=s[0].duree.split(":"),i=n[0],r=n[1];let a=o(t.date_examen).add(i,"hours");a=o(a).add(r,"minute");const c=o(t.date_examen,"DD-MM-YYYY HH:mm:ss").format("HH:mm")+" \xe0 "+a.format("HH:mm");this.sessionExamenService.updateSession(this.id,t).subscribe(e=>Object(h.b)(this,void 0,void 0,(function*(){e.success?(this.sessionEmail[0].email&&"en cours"!==t.etat_session&&"cl\xf4tur\xe9e"!==t.etat_session&&(null!==this.versions[0].version&&""!==this.versions[0].version||(this.SessionForm.value.version_session=null),"annul\xe9e"!==t.etat_session&&"report\xe9e"!==t.etat_session||(this.plannigBySession[0].statut_f="Annul\xe9e"),"confirm\xe9e"===t.etat_session&&(this.plannigBySession[0].statut_f="Confirm\xe9e"),yield this.envoyerEmail(this.sessionEmail[0].email,this.SessionForm.value.ref_formation,o(t.date_examen).format("DD-MM-YYYY"),c,t.langue,this.SessionForm.value.version_session,this.plannigBySession[0].statut_f,t.etat_session,this.sessionEmail[0].name,s[0].designation,t.lieu,this.plannigBySession[0].nbr_participant)),this.sessionEmail[0].email&&"en cours"!==t.etat_session&&"cl\xf4tur\xe9e"!==t.etat_session&&"confirm\xe9e"!==t.etat_session&&"en attente de confirmation"!==t.etat_session&&this.planningExamenService.editPlanningForSession({id:this.plannigBySession[0].id,statut_f:"annul\xe9e"}).subscribe(e=>{e.success||this.toastr.error("Erreur",e.error)}),this.sessionEmail[0].email&&"confirm\xe9e"===t.etat_session&&this.planningExamenService.editPlanningForSession({id:this.plannigBySession[0].id,statut_f:"Confirm\xe9e"}).subscribe(e=>{e.success||this.toastr.error("Erreur",e.error)}),this.toastr.success("Succ\xe8s"),this.router.navigate(["/admin/list-session-cours-examen/session-examen/list-examen"])):(this.toastr.error("Erreur",e.error),this.isLoading=!1)})))}fetchAllCours(){this.examenService.getAllCours().subscribe(e=>{this.allCours=e.results})}defautfetchCours(){this.examenService.getAllDistinctCours().subscribe(e=>{this.cours=e.result,this.filtercours=this.cours.filter(e=>e.categorie===this.Result.categorie)})}fetchSessionWithEmail(e){this.sessionExamenService.getSessionWithEmailById(e).subscribe(e=>{this.sessionEmail=e.result}),this.planningExamenService.getPlanningUpdatedByIdSession(this.id).subscribe(e=>{this.plannigBySession=e.result})}fetchCategorie(){this.categorieService.getAllCategories().subscribe(e=>{this.categories=e.results})}onchange(e){e&&(this.submitted=!1,this.displayVersion=!1,this.SessionForm.patchValue({ref_formation:"",version_session:""}),this.filtercours=[],this.filtercours=this.cours.filter(e=>e.categorie===this.SessionForm.value.cat_formation))}changeRef(e){e&&this.SessionForm.value.ref_formation&&(this.submitted=!1,this.versions=[],this.SessionForm.patchValue({version_session:""}),this.examenService.getAllVersionByRef(this.SessionForm.value.ref_formation).subscribe(e=>{this.versions=e.result,null!==this.versions[0].version&&""!==this.versions[0].version?(this.displayVersion=!0,this.SessionForm.get("version_session").setValidators(v.u.required)):(this.SessionForm.get("version_session").clearValidators(),this.displayVersion=!1)}))}defautversion(){this.versions=[],this.examenService.getAllVersionByRef(this.Result.ref_formation).subscribe(e=>{this.versions=e.result,null!==this.versions[0].version&&""!==this.versions[0].version?(this.displayVersion=!0,this.SessionForm.get("version_session").setValidators(v.u.required)):(this.SessionForm.get("version_session").clearValidators(),this.displayVersion=!1)})}envoyerEmail(e,s,t,n,i,o,r,a,c,l,u,d){this.sessionExamenService.envoyerEmailFormateur(e,s,t,n,i,o,r,a,c,l,u,d).subscribe(e=>{e.success||this.toastr.error("Error",e.error)})}}return e.\u0275fac=function(s){return new(s||e)(r.Vb(v.e),r.Vb(c.c),r.Vb(_.b),r.Vb(C.a),r.Vb(a.a),r.Vb(c.a),r.Vb(w.a),r.Vb(S.a),r.Vb(p.d))},e.\u0275cmp=r.Pb({type:e,selectors:[["app-edit-session-examen"]],decls:47,vars:38,consts:[[1,"content-wrapper"],[1,"content"],[1,"container-fluid"],[1,"text-right","mt-5",2,"padding-top","50px !important"],["routerLink","/admin/list-session-cours-examen/session-examen/list-examen",1,"btn","btn-success","mr-2"],[1,"fas","fa-arrow-alt-circle-left"],[1,"row","mb-2"],[1,"col-sm-12","text-center","mb-4"],[1,"edit-title"],[1,"col-12","col-md-6","mx-auto"],[3,"formGroup","ngSubmit"],[1,"input-group","mb-3"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Choisir une cat\xe9gorie","formControlName","cat_formation",3,"nzNotFoundContent","ngClass","ngModelChange"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["class","invalid-feedback",4,"ngIf"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Choisir une r\xe9f\xe9rence","formControlName","ref_formation",3,"nzNotFoundContent","ngClass","ngModelChange"],["class","input-group mb-3",4,"ngIf"],["nzFormat","yyyy-MM-dd HH:mm","formControlName","date_debut","nzPlaceHolder","Date",3,"nzShowTime","nzDisabledDate","ngClass"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Choisir une langue","formControlName","langue",3,"nzNotFoundContent","ngClass"],["nzLabel","Fran\xe7ais","nzValue","fran\xe7ais"],["nzLabel","Anglais","nzValue","anglais"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Choisir un pays","formControlName","lieu",3,"nzNotFoundContent","ngClass"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Choisir une statut de session","formControlName","etat_session",3,"nzNotFoundContent","ngClass"],["nzLabel","En attente de confirmation","nzValue","en attente de confirmation"],["nzLabel","Confirm\xe9e","nzValue","confirm\xe9e"],["nzLabel","En cours","nzValue","en cours"],["nzLabel","Cl\xf4tur\xe9e","nzValue","cl\xf4tur\xe9e"],["nzLabel","Report\xe9e","nzValue","report\xe9e"],["nzLabel","Annul\xe9e","nzValue","annul\xe9e"],[1,"row"],[1,"col-12","mb-4","text-center"],["type","submit","nz-button","","nzType","primary","nzBlock","",3,"nzLoading"],[3,"nzLabel","nzValue"],[1,"invalid-feedback"],[4,"ngIf"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Choisir une version","formControlName","version_session",3,"nzNotFoundContent","ngClass"]],template:function(e,s){1&e&&(r.bc(0,"div",0),r.bc(1,"section",1),r.bc(2,"div",2),r.bc(3,"div",3),r.bc(4,"button",4),r.Wb(5,"i",5),r.Rc(6," Retour "),r.ac(),r.ac(),r.bc(7,"div",6),r.bc(8,"div",7),r.bc(9,"h1",8),r.Rc(10," Modifier une session"),r.ac(),r.ac(),r.bc(11,"div",9),r.bc(12,"form",10),r.mc("ngSubmit",(function(){return s.onSubmit()})),r.bc(13,"div",11),r.bc(14,"nz-select",12),r.mc("ngModelChange",(function(e){return s.onchange(e)})),r.Pc(15,y,1,2,"nz-option",13),r.ac(),r.Pc(16,I,2,1,"div",14),r.ac(),r.bc(17,"div",11),r.bc(18,"nz-select",15),r.mc("ngModelChange",(function(e){return s.changeRef(e)})),r.Pc(19,L,1,2,"nz-option",13),r.ac(),r.Pc(20,N,2,1,"div",14),r.ac(),r.Pc(21,A,4,6,"div",16),r.bc(22,"div",11),r.Wb(23,"nz-date-picker",17),r.Pc(24,O,2,1,"div",14),r.ac(),r.bc(25,"div",11),r.bc(26,"nz-select",18),r.Wb(27,"nz-option",19),r.Wb(28,"nz-option",20),r.ac(),r.Pc(29,k,2,1,"div",14),r.ac(),r.bc(30,"div",11),r.bc(31,"nz-select",21),r.Pc(32,T,2,4,"nz-option",13),r.ac(),r.Pc(33,$,2,1,"div",14),r.ac(),r.bc(34,"div",11),r.bc(35,"nz-select",22),r.Wb(36,"nz-option",23),r.Wb(37,"nz-option",24),r.Wb(38,"nz-option",25),r.Wb(39,"nz-option",26),r.Wb(40,"nz-option",27),r.Wb(41,"nz-option",28),r.ac(),r.Pc(42,U,2,1,"div",14),r.ac(),r.bc(43,"div",29),r.bc(44,"div",30),r.bc(45,"button",31),r.Rc(46,"Enregistrer"),r.ac(),r.ac(),r.ac(),r.ac(),r.ac(),r.ac(),r.ac(),r.ac(),r.ac()),2&e&&(r.Hb(12),r.wc("formGroup",s.SessionForm),r.Hb(2),r.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",r.Bc(25,q,s.submitted&&s.f.cat_formation.errors)),r.Hb(1),r.wc("ngForOf",s.categories),r.Hb(1),r.wc("ngIf",s.submitted&&s.f.cat_formation.errors),r.Hb(2),r.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",r.Bc(27,q,s.submitted&&s.f.ref_formation.errors)),r.Hb(1),r.wc("ngForOf",s.filtercours),r.Hb(1),r.wc("ngIf",s.submitted&&s.f.ref_formation.errors),r.Hb(1),r.wc("ngIf",s.displayVersion),r.Hb(2),r.wc("nzShowTime",r.Ac(29,X))("nzDisabledDate",s.disabledDate)("ngClass",r.Bc(30,q,s.submitted&&s.f.date_debut.errors)),r.Hb(1),r.wc("ngIf",s.submitted&&s.f.date_debut.errors),r.Hb(2),r.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",r.Bc(32,q,s.submitted&&s.f.langue.errors)),r.Hb(3),r.wc("ngIf",s.submitted&&s.f.langue.errors),r.Hb(2),r.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",r.Bc(34,q,s.submitted&&s.f.lieu.errors)),r.Hb(1),r.wc("ngForOf",s.countryList),r.Hb(1),r.wc("ngIf",s.submitted&&s.f.lieu.errors),r.Hb(2),r.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",r.Bc(36,q,s.submitted&&s.f.etat_session.errors)),r.Hb(7),r.wc("ngIf",s.submitted&&s.f.etat_session.errors),r.Hb(3),r.wc("nzLoading",s.isLoading))},directives:[c.d,v.w,v.n,v.h,H.b,v.m,v.g,n.l,n.m,n.n,x.a,H.a,R.a,P.a,F.a],pipes:[n.x],styles:["@media(max-width:768px){.add-title[_ngcontent-%COMP%]{font-size:2rem!important;margin-top:50px}.form-control[_ngcontent-%COMP%]{font-size:.8rem!important}}nz-date-picker[_ngcontent-%COMP%], nz-select[_ngcontent-%COMP%]{width:100%}.padding-custom[_ngcontent-%COMP%]{padding-bottom:100px}"]}),e})();function K(e,s){if(1&e&&r.Wb(0,"nz-option",29),2&e){const e=s.$implicit;r.xc("nzLabel",e.nom_categorie),r.wc("nzValue",e.nom_categorie)}}function J(e,s){1&e&&(r.bc(0,"div"),r.Rc(1,"cat\xe9gorie est obligatoire"),r.ac())}function Q(e,s){if(1&e&&(r.bc(0,"div",30),r.Pc(1,J,2,0,"div",31),r.ac()),2&e){const e=r.pc();r.Hb(1),r.wc("ngIf",e.f.cat_formation.errors.required)}}function ee(e,s){if(1&e&&r.Wb(0,"nz-option",29),2&e){const e=s.$implicit;r.xc("nzLabel",e.ref_form),r.wc("nzValue",e.ref_form)}}function se(e,s){1&e&&(r.bc(0,"div"),r.Rc(1,"R\xe9f\xe9rence est obligatoire"),r.ac())}function te(e,s){if(1&e&&(r.bc(0,"div",30),r.Pc(1,se,2,0,"div",31),r.ac()),2&e){const e=r.pc(2);r.Hb(1),r.wc("ngIf",e.f.ref_formation.errors.required)}}const ne=function(e){return{"is-invalid":e}};function ie(e,s){if(1&e){const e=r.cc();r.bc(0,"div",11),r.bc(1,"nz-select",32),r.mc("ngModelChange",(function(s){return r.Gc(e),r.pc().changeRef(s)})),r.Pc(2,ee,1,2,"nz-option",13),r.ac(),r.Pc(3,te,2,1,"div",14),r.ac()}if(2&e){const e=r.pc();r.Hb(1),r.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",r.Bc(4,ne,e.submitted&&e.f.ref_formation.errors)),r.Hb(1),r.wc("ngForOf",e.cours),r.Hb(1),r.wc("ngIf",e.submitted&&e.f.ref_formation.errors)}}function oe(e,s){if(1&e&&r.Wb(0,"nz-option",29),2&e){const e=s.$implicit;r.xc("nzLabel",e.version),r.wc("nzValue",e.version)}}function re(e,s){1&e&&(r.bc(0,"div"),r.Rc(1,"version est obligatoire"),r.ac())}function ae(e,s){if(1&e&&(r.bc(0,"div",30),r.Pc(1,re,2,0,"div",31),r.ac()),2&e){const e=r.pc(2);r.Hb(1),r.wc("ngIf",e.f.version_session.errors.required)}}function ce(e,s){if(1&e&&(r.bc(0,"div",11),r.bc(1,"nz-select",33),r.Pc(2,oe,1,2,"nz-option",13),r.ac(),r.Pc(3,ae,2,1,"div",14),r.ac()),2&e){const e=r.pc();r.Hb(1),r.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",r.Bc(4,ne,e.submitted&&e.f.version_session.errors)),r.Hb(1),r.wc("ngForOf",e.versions),r.Hb(1),r.wc("ngIf",e.submitted&&e.f.version_session.errors)}}function le(e,s){1&e&&(r.bc(0,"div"),r.Rc(1,"Date est obligatoire"),r.ac())}function ue(e,s){if(1&e&&(r.bc(0,"div",30),r.Pc(1,le,2,0,"div",31),r.ac()),2&e){const e=r.pc();r.Hb(1),r.wc("ngIf",e.f.date_debut.errors.required)}}function de(e,s){1&e&&(r.bc(0,"div"),r.Rc(1,"langue est obligatoire"),r.ac())}function be(e,s){if(1&e&&(r.bc(0,"div",30),r.Pc(1,de,2,0,"div",31),r.ac()),2&e){const e=r.pc();r.Hb(1),r.wc("ngIf",e.f.langue.errors.required)}}function me(e,s){if(1&e&&(r.Wb(0,"nz-option",29),r.qc(1,"titlecase")),2&e){const e=s.$implicit;r.xc("nzLabel",r.rc(1,2,e.name)),r.wc("nzValue",e.name)}}function fe(e,s){1&e&&(r.bc(0,"div"),r.Rc(1,"Pays est obligatoire"),r.ac())}function he(e,s){if(1&e&&(r.bc(0,"div",30),r.Pc(1,fe,2,0,"div",31),r.ac()),2&e){const e=r.pc();r.Hb(1),r.wc("ngIf",e.f.lieu.errors.required)}}function ge(e,s){1&e&&(r.bc(0,"div"),r.Rc(1,"statut de session est obligatoire"),r.ac())}function ve(e,s){if(1&e&&(r.bc(0,"div",30),r.Pc(1,ge,2,0,"div",31),r.ac()),2&e){const e=r.pc();r.Hb(1),r.wc("ngIf",e.f.etat_session.errors.required)}}const pe=function(){return{nzFormat:"HH:mm"}};let ze=(()=>{class e{constructor(e,s,t,n,i,o,r){this.formBuilder=e,this.router=s,this.toastr=t,this.examenService=n,this.sessionExamenService=i,this.categorieService=o,this.i18n=r,this.submitted=!1,this.displayRef=!1,this.displayVersion=!1,this.displayCountry=!1,this.cours=[],this.testcours=[],this.filtercours=[],this.categories=[],this.versions=[],this.allCours=[],this.verif=!1,this.title="json-file-read-angular",this.today=new Date,this.isLoading=!1,this.countryList=g,this.disabledDate=e=>Object(z.a)(e,this.today)<0}ngOnInit(){this.i18n.setLocale(p.e),this.fetchCategorie(),this.fetchCours(),this.fetchAllCours(),this.SessionForm=this.formBuilder.group({ref_formation:["",[v.u.required]],version_session:[""],cat_formation:["",[v.u.required]],date_debut:["",[v.u.required]],langue:["",[v.u.required]],lieu:["",[v.u.required]],etat_session:["en attente de confirmation",[v.u.required]]})}get f(){return this.SessionForm.controls}onSubmit(){if(this.submitted=!0,this.SessionForm.invalid)return;if(this.isLoading=!0,this.submitted=!0,this.SessionForm.invalid)return;const e=o(this.SessionForm.value.date_debut).format("YYYY-MM-DD HH:mm:ss");let s=[];s=this.allCours.filter(null!==this.versions[0].version&&""!==this.versions[0].version?e=>e.ref_form===this.SessionForm.value.ref_formation&&e.version===this.SessionForm.value.version_session:e=>e.ref_form===this.SessionForm.value.ref_formation),this.sessionExamenService.saveSession({id_examen:s[0].id,date_examen:e,langue:this.SessionForm.value.langue,lieu:this.SessionForm.value.lieu||null,etat_session:this.SessionForm.value.etat_session}).subscribe(e=>{e.success?(this.toastr.success("Succ\xe8s"),this.router.navigate(["/admin/list-session-cours-examen/session-examen/list-examen"])):(this.toastr.error("Erreur",e.error),this.isLoading=!1)})}onchange(e){e&&(this.displayRef=!0,this.displayVersion=!1,this.SessionForm.patchValue({ref_formation:"",version_session:""}),this.submitted=!1,this.filtercours=this.testcours.filter(e=>e.categorie===this.SessionForm.value.cat_formation),this.cours=this.filtercours.map(e=>e))}changeRef(e){e&&(this.versions=[],this.SessionForm.patchValue({version_session:""}),this.submitted=!1,this.examenService.getAllVersionByRef(this.SessionForm.value.ref_formation).subscribe(e=>{this.versions=e.result,null!==this.versions[0].version&&""!==this.versions[0].version?(this.displayVersion=!0,this.SessionForm.get("version_session").setValidators(v.u.required)):(this.SessionForm.get("version_session").clearValidators(),this.displayVersion=!1,this.SessionForm.patchValue({version_session:""}))}))}fetchCours(){this.examenService.getAllDistinctCours().subscribe(e=>{this.testcours=e.result,this.cours=e.result})}fetchAllCours(){this.examenService.getAllCours().subscribe(e=>{this.allCours=e.results})}fetchCategorie(){this.categorieService.getAllCategories().subscribe(e=>{this.categories=e.results})}}return e.\u0275fac=function(s){return new(s||e)(r.Vb(v.e),r.Vb(c.c),r.Vb(_.b),r.Vb(C.a),r.Vb(a.a),r.Vb(w.a),r.Vb(p.d))},e.\u0275cmp=r.Pb({type:e,selectors:[["app-add-session-examen"]],decls:42,vars:33,consts:[[1,"content-wrapper"],[1,"content"],[1,"container-fluid"],[1,"text-right","mt-5",2,"padding-top","50px !important"],["routerLink","/admin/list-session-cours-examen/session-examen/list-examen",1,"btn","btn-success","mr-2"],[1,"fas","fa-arrow-alt-circle-left"],[1,"row","mb-2","padding-custom"],[1,"col-sm-12","text-center","mb-4"],[1,"add-title"],[1,"col-12","col-md-6","mx-auto"],[3,"formGroup","ngSubmit"],[1,"input-group","mb-3"],["nzPlaceHolder","Choisir une cat\xe9gorie","formControlName","cat_formation",3,"nzNotFoundContent","ngClass","ngModelChange"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["class","invalid-feedback",4,"ngIf"],["class","input-group mb-3",4,"ngIf"],["nzFormat","yyyy-MM-dd HH:mm","formControlName","date_debut","nzPlaceHolder","Date",3,"nzShowTime","nzDisabledDate","ngClass"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Choisir une langue","formControlName","langue",3,"nzNotFoundContent","ngClass"],["nzLabel","Fran\xe7ais","nzValue","fran\xe7ais"],["nzLabel","Anglais","nzValue","anglais"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Choisir un pays","formControlName","lieu",3,"nzNotFoundContent","ngClass"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Choisir une statut de session","formControlName","etat_session",3,"nzNotFoundContent","ngClass"],["nzLabel","En attente de confirmation","nzValue","en attente de confirmation"],["nzLabel","Confirm\xe9e","nzValue","confirm\xe9e"],["nzLabel","Report\xe9e","nzValue","report\xe9e"],["nzLabel","Annul\xe9e","nzValue","annul\xe9e"],[1,"row"],[1,"col-12","mb-4","text-center"],["type","submit","nz-button","","nzType","primary","nzBlock","",3,"nzLoading"],[3,"nzLabel","nzValue"],[1,"invalid-feedback"],[4,"ngIf"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Choisir une r\xe9f\xe9rence","formControlName","ref_formation",3,"nzNotFoundContent","ngClass","ngModelChange"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Choisir une version","formControlName","version_session",3,"nzNotFoundContent","ngClass"]],template:function(e,s){1&e&&(r.bc(0,"div",0),r.bc(1,"section",1),r.bc(2,"div",2),r.bc(3,"div",3),r.bc(4,"button",4),r.Wb(5,"i",5),r.Rc(6," Retour "),r.ac(),r.ac(),r.bc(7,"div",6),r.bc(8,"div",7),r.bc(9,"h1",8),r.Rc(10,"Ajouter une session"),r.ac(),r.ac(),r.bc(11,"div",9),r.bc(12,"form",10),r.mc("ngSubmit",(function(){return s.onSubmit()})),r.bc(13,"div",11),r.bc(14,"nz-select",12),r.mc("ngModelChange",(function(e){return s.onchange(e)})),r.Pc(15,K,1,2,"nz-option",13),r.ac(),r.Pc(16,Q,2,1,"div",14),r.ac(),r.Pc(17,ie,4,6,"div",15),r.Pc(18,ce,4,6,"div",15),r.bc(19,"div",11),r.Wb(20,"nz-date-picker",16),r.Pc(21,ue,2,1,"div",14),r.ac(),r.bc(22,"div",11),r.bc(23,"nz-select",17),r.Wb(24,"nz-option",18),r.Wb(25,"nz-option",19),r.ac(),r.Pc(26,be,2,1,"div",14),r.ac(),r.bc(27,"div",11),r.bc(28,"nz-select",20),r.Pc(29,me,2,4,"nz-option",13),r.ac(),r.Pc(30,he,2,1,"div",14),r.ac(),r.bc(31,"div",11),r.bc(32,"nz-select",21),r.Wb(33,"nz-option",22),r.Wb(34,"nz-option",23),r.Wb(35,"nz-option",24),r.Wb(36,"nz-option",25),r.ac(),r.Pc(37,ve,2,1,"div",14),r.ac(),r.bc(38,"div",26),r.bc(39,"div",27),r.bc(40,"button",28),r.Rc(41,"Enregistrer"),r.ac(),r.ac(),r.ac(),r.ac(),r.ac(),r.ac(),r.ac(),r.ac(),r.ac()),2&e&&(r.Hb(12),r.wc("formGroup",s.SessionForm),r.Hb(2),r.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",r.Bc(22,ne,s.submitted&&s.f.cat_formation.errors)),r.Hb(1),r.wc("ngForOf",s.categories),r.Hb(1),r.wc("ngIf",s.submitted&&s.f.cat_formation.errors),r.Hb(1),r.wc("ngIf",s.displayRef),r.Hb(1),r.wc("ngIf",s.displayVersion),r.Hb(2),r.wc("nzShowTime",r.Ac(24,pe))("nzDisabledDate",s.disabledDate)("ngClass",r.Bc(25,ne,s.submitted&&s.f.date_debut.errors)),r.Hb(1),r.wc("ngIf",s.submitted&&s.f.date_debut.errors),r.Hb(2),r.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",r.Bc(27,ne,s.submitted&&s.f.langue.errors)),r.Hb(3),r.wc("ngIf",s.submitted&&s.f.langue.errors),r.Hb(2),r.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",r.Bc(29,ne,s.submitted&&s.f.lieu.errors)),r.Hb(1),r.wc("ngForOf",s.countryList),r.Hb(1),r.wc("ngIf",s.submitted&&s.f.lieu.errors),r.Hb(2),r.wc("nzNotFoundContent","Pas de r\xe9sultat")("ngClass",r.Bc(31,ne,s.submitted&&s.f.etat_session.errors)),r.Hb(5),r.wc("ngIf",s.submitted&&s.f.etat_session.errors),r.Hb(3),r.wc("nzLoading",s.isLoading))},directives:[c.d,v.w,v.n,v.h,H.b,v.m,v.g,n.l,n.m,n.n,x.a,H.a,R.a,P.a,F.a],pipes:[n.x],styles:["@media(max-width:768px){.add-title[_ngcontent-%COMP%]{font-size:2rem!important;margin-top:50px}.form-control[_ngcontent-%COMP%]{font-size:.8rem!important}}nz-date-picker[_ngcontent-%COMP%], nz-select[_ngcontent-%COMP%]{width:100%}.padding-custom[_ngcontent-%COMP%]{padding-bottom:100px}"]}),e})();var _e=t("dMYC"),Ce=t("HztV");const we=[{path:"",component:(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(s){return new(s||e)},e.\u0275cmp=r.Pb({type:e,selectors:[["app-session-examen"]],decls:1,vars:0,template:function(e,s){1&e&&r.Wb(0,"router-outlet")},directives:[c.h],styles:[""]}),e})(),children:[{path:"list-session-examan",component:Ce.a},{path:"list-session-examan-inactive",component:_e.a},{path:"add-session-examan",component:ze,canActivate:[i.a]},{path:"edit-session-examan/:id",component:Z,canActivate:[i.a]},{path:"show-session-examan/:id",component:f}]}];let Se=(()=>{class e{}return e.\u0275mod=r.Tb({type:e}),e.\u0275inj=r.Sb({factory:function(s){return new(s||e)},imports:[[c.g.forChild(we)],c.g]}),e})();var He=t("rMZv"),xe=t("PTRe"),Re=t("OtHt"),Pe=t("cZdB"),Fe=t("1kSV"),ye=t("ix5O");let Ve=(()=>{class e{}return e.\u0275mod=r.Tb({type:e}),e.\u0275inj=r.Sb({factory:function(s){return new(s||e)},imports:[[n.c,Se,Pe.b,v.i,v.s,Fe.d,H.c,He.d,xe.c,Re.b,x.b,ye.b,R.c]]}),e})()}}]);